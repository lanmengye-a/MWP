Epoch: 0
Batch: 0
cids for sample[-1] in batch: [4 3]
Cand prob for sample[-1] in batch: [0.1084, 0.13855, 0.10379, 0.13392, 0.11538, 0.10999, 0.14534, 0.14462]
### reward for the batch: 2
### loss for the batch: 13.260701179504395

Batch: 1
cids for sample[-1] in batch: [4 2]
Cand prob for sample[-1] in batch: [0.15767, 0.08486, 0.22377, 0.25665, 0.05861, 0.16218, 0.04117, 0.01508]
### reward for the batch: 2
### loss for the batch: 13.207218170166016

Batch: 2
cids for sample[-1] in batch: [4 0]
Cand prob for sample[-1] in batch: [0.07065, 0.07326, 0.1553, 0.13884, 0.36712, 0.13269, 0.04118, 0.02096]
### reward for the batch: 0
### loss for the batch: 0.8399438858032227

Batch: 3
cids for sample[-1] in batch: [3 4]
Cand prob for sample[-1] in batch: [0.02657, 0.02806, 0.01133, 0.0261, 0.84668, 0.04117, 0.01381, 0.00628]
### reward for the batch: 2
### loss for the batch: 15.457663536071777

Batch: 4
cids for sample[-1] in batch: [6 4]
Cand prob for sample[-1] in batch: [0.14954, 0.04685, 0.08744, 0.11019, 0.39466, 0.12696, 0.06788, 0.01648]
### reward for the batch: 2
### loss for the batch: 12.448017120361328

Batch: 5
cids for sample[-1] in batch: [2 4]
Cand prob for sample[-1] in batch: [0.21707, 0.04145, 0.15611, 0.12495, 0.1604, 0.18265, 0.10539, 0.01198]
### reward for the batch: 2
### loss for the batch: 11.252010345458984

Batch: 6
cids for sample[-1] in batch: [2 5]
Cand prob for sample[-1] in batch: [0.21064, 0.03162, 0.27446, 0.18695, 0.05375, 0.12216, 0.11409, 0.00633]
### reward for the batch: 2
### loss for the batch: 13.305694580078125

Batch: 7
cids for sample[-1] in batch: [5 3]
Cand prob for sample[-1] in batch: [0.1602, 0.03466, 0.2265, 0.23556, 0.06625, 0.13685, 0.12865, 0.01132]
### reward for the batch: 2
### loss for the batch: 15.206300735473633

Batch: 8
cids for sample[-1] in batch: [2 0]
Cand prob for sample[-1] in batch: [0.12848, 0.0563, 0.21596, 0.16177, 0.07419, 0.14053, 0.17787, 0.04489]
### reward for the batch: 2
### loss for the batch: 10.524145126342773

Batch: 9
cids for sample[-1] in batch: [4 6]
Cand prob for sample[-1] in batch: [0.105, 0.06583, 0.23898, 0.11703, 0.07695, 0.11972, 0.18505, 0.09144]
### reward for the batch: 2
### loss for the batch: 12.385551452636719

============================================
### Epoch: 0 / 20
### Total reward: 18, Total loss: 117.88725, Best reward: 18 at epoch 0, Best loss: 117.88725 at epoch 0

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_0.pt
saved the best reward ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_best_reward.pt
saved the best loss ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_best_loss.pt
============================================

Epoch: 1
Batch: 0
cids for sample[-1] in batch: [2 1]
Cand prob for sample[-1] in batch: [0.065, 0.05996, 0.17607, 0.169, 0.11102, 0.13988, 0.17497, 0.1041]
### reward for the batch: 2
### loss for the batch: 12.577831268310547

Batch: 1
cids for sample[-1] in batch: [6 5]
Cand prob for sample[-1] in batch: [0.0486, 0.07896, 0.1086, 0.06421, 0.16129, 0.0661, 0.16125, 0.31099]
### reward for the batch: 2
### loss for the batch: 11.775395393371582

Batch: 2
cids for sample[-1] in batch: [3 7]
Cand prob for sample[-1] in batch: [0.01304, 0.04836, 0.01507, 0.00869, 0.13413, 0.01086, 0.07006, 0.69979]
### reward for the batch: 0
### loss for the batch: 2.923708915710449

Batch: 3
cids for sample[-1] in batch: [7 6]
Cand prob for sample[-1] in batch: [0.01439, 0.07704, 0.01312, 0.01489, 0.30949, 0.02455, 0.07126, 0.47526]
### reward for the batch: 2
### loss for the batch: 13.521808624267578

Batch: 4
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.01219, 0.05539, 0.03066, 0.00905, 0.40924, 0.01716, 0.07309, 0.39322]
### reward for the batch: 2
### loss for the batch: 18.03580665588379

Batch: 5
cids for sample[-1] in batch: [4 7]
Cand prob for sample[-1] in batch: [0.02946, 0.07721, 0.06844, 0.04234, 0.42912, 0.06731, 0.10288, 0.18324]
### reward for the batch: 2
### loss for the batch: 10.454427719116211

Batch: 6
cids for sample[-1] in batch: [5 0]
Cand prob for sample[-1] in batch: [0.04027, 0.09857, 0.08992, 0.07268, 0.26314, 0.12679, 0.17696, 0.13167]
### reward for the batch: 2
### loss for the batch: 13.072526931762695

Batch: 7
cids for sample[-1] in batch: [3 4]
Cand prob for sample[-1] in batch: [0.05805, 0.10525, 0.0802, 0.12429, 0.19297, 0.16435, 0.16376, 0.11113]
### reward for the batch: 2
### loss for the batch: 11.950510025024414

Batch: 8
cids for sample[-1] in batch: [5 3]
Cand prob for sample[-1] in batch: [0.08047, 0.13017, 0.08284, 0.10525, 0.14057, 0.15807, 0.18258, 0.12005]
### reward for the batch: 2
### loss for the batch: 12.669057846069336

Batch: 9
cids for sample[-1] in batch: [1 5]
Cand prob for sample[-1] in batch: [0.10151, 0.15827, 0.09159, 0.13469, 0.09343, 0.16313, 0.18024, 0.07714]
### reward for the batch: 2
### loss for the batch: 12.476621627807617

============================================
### Epoch: 1 / 20
### Total reward: 18, Total loss: 119.4577, Best reward: 18 at epoch 0, Best loss: 117.88725 at epoch 0

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_1.pt
============================================

Epoch: 2
Batch: 0
cids for sample[-1] in batch: [3 0]
Cand prob for sample[-1] in batch: [0.06413, 0.11469, 0.10296, 0.2558, 0.04189, 0.28444, 0.12137, 0.01472]
### reward for the batch: 2
### loss for the batch: 13.521005630493164

Batch: 1
cids for sample[-1] in batch: [1 7]
Cand prob for sample[-1] in batch: [0.09955, 0.15475, 0.08913, 0.23411, 0.03528, 0.23359, 0.13759, 0.01599]
### reward for the batch: 2
### loss for the batch: 14.057619094848633

Batch: 2
cids for sample[-1] in batch: [5 0]
Cand prob for sample[-1] in batch: [0.15816, 0.31096, 0.05649, 0.15056, 0.02754, 0.0985, 0.15483, 0.04296]
### reward for the batch: 0
### loss for the batch: 1.4411377906799316

Batch: 3
cids for sample[-1] in batch: [1 6]
Cand prob for sample[-1] in batch: [0.11378, 0.55597, 0.03645, 0.09826, 0.01912, 0.06347, 0.09525, 0.01769]
### reward for the batch: 2
### loss for the batch: 13.955364227294922

Batch: 4
cids for sample[-1] in batch: [3 1]
Cand prob for sample[-1] in batch: [0.13654, 0.51623, 0.07504, 0.06388, 0.03879, 0.0415, 0.09552, 0.03249]
### reward for the batch: 2
### loss for the batch: 12.158226013183594

Batch: 5
cids for sample[-1] in batch: [3 1]
Cand prob for sample[-1] in batch: [0.1814, 0.45614, 0.06868, 0.05335, 0.07476, 0.03524, 0.09353, 0.03689]
### reward for the batch: 2
### loss for the batch: 12.17689323425293

Batch: 6
cids for sample[-1] in batch: [5 1]
Cand prob for sample[-1] in batch: [0.20896, 0.42883, 0.05441, 0.05237, 0.07106, 0.04362, 0.11251, 0.02823]
### reward for the batch: 2
### loss for the batch: 10.805000305175781

Batch: 7
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.24451, 0.32712, 0.04551, 0.08992, 0.10965, 0.05046, 0.09664, 0.03619]
### reward for the batch: 2
### loss for the batch: 13.726417541503906

Batch: 8
cids for sample[-1] in batch: [7 6]
Cand prob for sample[-1] in batch: [0.31221, 0.11983, 0.04031, 0.11142, 0.10227, 0.12748, 0.12424, 0.06224]
### reward for the batch: 2
### loss for the batch: 14.308101654052734

Batch: 9
cids for sample[-1] in batch: [3 2]
Cand prob for sample[-1] in batch: [0.20895, 0.0755, 0.03884, 0.11971, 0.17187, 0.15737, 0.14209, 0.08567]
### reward for the batch: 2
### loss for the batch: 12.847803115844727

============================================
### Epoch: 2 / 20
### Total reward: 18, Total loss: 118.99757, Best reward: 18 at epoch 0, Best loss: 117.88725 at epoch 0

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_2.pt
============================================

Epoch: 3
Batch: 0
cids for sample[-1] in batch: [3 5]
Cand prob for sample[-1] in batch: [0.12615, 0.03828, 0.07292, 0.16516, 0.14841, 0.24708, 0.14092, 0.06107]
### reward for the batch: 2
### loss for the batch: 10.221650123596191

Batch: 1
cids for sample[-1] in batch: [3 1]
Cand prob for sample[-1] in batch: [0.11253, 0.01534, 0.06415, 0.15728, 0.10704, 0.3043, 0.16365, 0.0757]
### reward for the batch: 2
### loss for the batch: 11.886820793151855

Batch: 2
cids for sample[-1] in batch: [2 7]
Cand prob for sample[-1] in batch: [0.09285, 0.00488, 0.03265, 0.16708, 0.06059, 0.33593, 0.19844, 0.10759]
### reward for the batch: 0
### loss for the batch: -0.5318832397460938

Batch: 3
cids for sample[-1] in batch: [7 5]
Cand prob for sample[-1] in batch: [0.02961, 0.00402, 0.03391, 0.20061, 0.05732, 0.44625, 0.18413, 0.04415]
### reward for the batch: 2
### loss for the batch: 12.441553115844727

Batch: 4
cids for sample[-1] in batch: [2 5]
Cand prob for sample[-1] in batch: [0.02631, 0.00491, 0.09936, 0.23633, 0.06243, 0.35923, 0.1659, 0.04552]
### reward for the batch: 2
### loss for the batch: 12.404272079467773

Batch: 5
cids for sample[-1] in batch: [5 2]
Cand prob for sample[-1] in batch: [0.03502, 0.00469, 0.10311, 0.24087, 0.05233, 0.37803, 0.13564, 0.05032]
### reward for the batch: 2
### loss for the batch: 10.86142349243164

Batch: 6
cids for sample[-1] in batch: [5 3]
Cand prob for sample[-1] in batch: [0.03075, 0.00347, 0.10369, 0.21781, 0.02481, 0.4558, 0.12742, 0.03625]
### reward for the batch: 2
### loss for the batch: 8.58713150024414

Batch: 7
cids for sample[-1] in batch: [5 4]
Cand prob for sample[-1] in batch: [0.05404, 0.00388, 0.10292, 0.32841, 0.02564, 0.32959, 0.10578, 0.04973]
### reward for the batch: 2
### loss for the batch: 13.97966194152832

Batch: 8
cids for sample[-1] in batch: [0 3]
Cand prob for sample[-1] in batch: [0.06002, 0.00551, 0.11524, 0.23631, 0.04306, 0.25604, 0.18793, 0.09589]
### reward for the batch: 2
### loss for the batch: 12.077702522277832

Batch: 9
cids for sample[-1] in batch: [1 0]
Cand prob for sample[-1] in batch: [0.06751, 0.00566, 0.14447, 0.3067, 0.04476, 0.17283, 0.1798, 0.07826]
### reward for the batch: 2
### loss for the batch: 16.522768020629883

============================================
### Epoch: 3 / 20
### Total reward: 18, Total loss: 108.4511, Best reward: 18 at epoch 0, Best loss: 108.4511 at epoch 3

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_3.pt
saved the best loss ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_best_loss.pt
============================================

Epoch: 4
Batch: 0
cids for sample[-1] in batch: [7 3]
Cand prob for sample[-1] in batch: [0.15638, 0.00863, 0.15314, 0.30449, 0.04115, 0.15887, 0.14022, 0.03713]
### reward for the batch: 2
### loss for the batch: 14.180838584899902

Batch: 1
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.31095, 0.0148, 0.11344, 0.20936, 0.04849, 0.08537, 0.16655, 0.05105]
### reward for the batch: 2
### loss for the batch: 9.305793762207031

Batch: 2
cids for sample[-1] in batch: [3 0]
Cand prob for sample[-1] in batch: [0.59274, 0.00819, 0.02908, 0.08351, 0.04023, 0.02468, 0.13491, 0.08666]
### reward for the batch: 0
### loss for the batch: 3.2693028450012207

Batch: 3
cids for sample[-1] in batch: [0 3]
Cand prob for sample[-1] in batch: [0.50224, 0.02007, 0.03276, 0.15237, 0.05514, 0.03567, 0.14419, 0.05754]
### reward for the batch: 2
### loss for the batch: 10.77987289428711

Batch: 4
cids for sample[-1] in batch: [2 6]
Cand prob for sample[-1] in batch: [0.4449, 0.08438, 0.08469, 0.13475, 0.07834, 0.01707, 0.11816, 0.03771]
### reward for the batch: 2
### loss for the batch: 13.052952766418457

Batch: 5
cids for sample[-1] in batch: [2 6]
Cand prob for sample[-1] in batch: [0.37914, 0.18451, 0.08364, 0.1452, 0.06225, 0.01744, 0.10768, 0.02013]
### reward for the batch: 2
### loss for the batch: 16.10434913635254

Batch: 6
cids for sample[-1] in batch: [1 2]
Cand prob for sample[-1] in batch: [0.1914, 0.3808, 0.08148, 0.15509, 0.0469, 0.01453, 0.11738, 0.01242]
### reward for the batch: 2
### loss for the batch: 11.14346694946289

Batch: 7
cids for sample[-1] in batch: [0 1]
Cand prob for sample[-1] in batch: [0.08632, 0.52004, 0.09163, 0.09002, 0.09142, 0.00835, 0.09388, 0.01835]
### reward for the batch: 2
### loss for the batch: 12.16248893737793

Batch: 8
cids for sample[-1] in batch: [2 1]
Cand prob for sample[-1] in batch: [0.02547, 0.7129, 0.09619, 0.0225, 0.07532, 0.0015, 0.05474, 0.01139]
### reward for the batch: 2
### loss for the batch: 17.198562622070312

Batch: 9
cids for sample[-1] in batch: [2 1]
Cand prob for sample[-1] in batch: [0.03373, 0.46392, 0.23867, 0.05963, 0.09542, 0.00392, 0.08315, 0.02156]
### reward for the batch: 2
### loss for the batch: 13.79816722869873

============================================
### Epoch: 4 / 20
### Total reward: 18, Total loss: 120.9958, Best reward: 18 at epoch 0, Best loss: 108.4511 at epoch 3

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_4.pt
============================================

Epoch: 5
Batch: 0
cids for sample[-1] in batch: [6 3]
Cand prob for sample[-1] in batch: [0.08008, 0.17675, 0.35356, 0.18813, 0.07684, 0.02066, 0.08083, 0.02315]
### reward for the batch: 2
### loss for the batch: 11.381426811218262

Batch: 1
cids for sample[-1] in batch: [1 2]
Cand prob for sample[-1] in batch: [0.11409, 0.09979, 0.35677, 0.21856, 0.06643, 0.02545, 0.08849, 0.03043]
### reward for the batch: 2
### loss for the batch: 11.798903465270996

Batch: 2
cids for sample[-1] in batch: [6 2]
Cand prob for sample[-1] in batch: [0.18354, 0.05261, 0.26745, 0.20374, 0.0835, 0.02304, 0.10011, 0.08602]
### reward for the batch: 0
### loss for the batch: -3.17758846282959

Batch: 3
cids for sample[-1] in batch: [2 3]
Cand prob for sample[-1] in batch: [0.14106, 0.03258, 0.19419, 0.34793, 0.06521, 0.05809, 0.10904, 0.05189]
### reward for the batch: 2
### loss for the batch: 13.715371131896973

Batch: 4
cids for sample[-1] in batch: [2 3]
Cand prob for sample[-1] in batch: [0.0776, 0.03251, 0.43839, 0.25821, 0.05657, 0.02322, 0.08037, 0.03314]
### reward for the batch: 2
### loss for the batch: 11.475358963012695

Batch: 5
cids for sample[-1] in batch: [3 6]
Cand prob for sample[-1] in batch: [0.1202, 0.03822, 0.23893, 0.28176, 0.06932, 0.07019, 0.12369, 0.05768]
### reward for the batch: 2
### loss for the batch: 13.242939949035645

Batch: 6
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.15955, 0.03264, 0.08689, 0.3501, 0.03497, 0.14681, 0.14337, 0.04568]
### reward for the batch: 2
### loss for the batch: 14.765467643737793

Batch: 7
cids for sample[-1] in batch: [5 7]
Cand prob for sample[-1] in batch: [0.19144, 0.02597, 0.02351, 0.18295, 0.06632, 0.21275, 0.15125, 0.14582]
### reward for the batch: 2
### loss for the batch: 12.820262908935547

Batch: 8
cids for sample[-1] in batch: [4 0]
Cand prob for sample[-1] in batch: [0.2, 0.02726, 0.01153, 0.08746, 0.09136, 0.18913, 0.15611, 0.23715]
### reward for the batch: 2
### loss for the batch: 11.073057174682617

Batch: 9
cids for sample[-1] in batch: [5 7]
Cand prob for sample[-1] in batch: [0.11749, 0.02414, 0.00204, 0.02168, 0.12329, 0.1652, 0.13048, 0.41568]
### reward for the batch: 2
### loss for the batch: 13.16207218170166

============================================
### Epoch: 5 / 20
### Total reward: 18, Total loss: 110.25727, Best reward: 18 at epoch 0, Best loss: 108.4511 at epoch 3

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_5.pt
============================================

Epoch: 6
Batch: 0
cids for sample[-1] in batch: [5 4]
Cand prob for sample[-1] in batch: [0.1205, 0.02857, 0.00114, 0.01724, 0.17273, 0.3183, 0.08738, 0.25414]
### reward for the batch: 2
### loss for the batch: 15.072610855102539

Batch: 1
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.12695, 0.04012, 0.0012, 0.0132, 0.18439, 0.37738, 0.07514, 0.18162]
### reward for the batch: 2
### loss for the batch: 19.589557647705078

Batch: 2
cids for sample[-1] in batch: [5 0]
Cand prob for sample[-1] in batch: [0.13851, 0.04913, 0.00146, 0.01086, 0.32341, 0.18197, 0.0733, 0.22137]
### reward for the batch: 0
### loss for the batch: 0.31173229217529297

Batch: 3
cids for sample[-1] in batch: [5 4]
Cand prob for sample[-1] in batch: [0.06684, 0.091, 0.00035, 0.00441, 0.44276, 0.27965, 0.04345, 0.07156]
### reward for the batch: 2
### loss for the batch: 10.51264762878418

Batch: 4
cids for sample[-1] in batch: [1 4]
Cand prob for sample[-1] in batch: [0.07631, 0.22111, 0.00229, 0.0078, 0.3855, 0.18733, 0.06114, 0.05852]
### reward for the batch: 2
### loss for the batch: 10.6774320602417

Batch: 5
cids for sample[-1] in batch: [5 1]
Cand prob for sample[-1] in batch: [0.06008, 0.48316, 0.00134, 0.00372, 0.19896, 0.19074, 0.04506, 0.01694]
### reward for the batch: 2
### loss for the batch: 14.712217330932617

Batch: 6
cids for sample[-1] in batch: [5 1]
Cand prob for sample[-1] in batch: [0.03262, 0.75337, 0.00071, 0.00166, 0.0599, 0.12579, 0.02257, 0.00338]
### reward for the batch: 2
### loss for the batch: 13.224227905273438

Batch: 7
cids for sample[-1] in batch: [5 1]
Cand prob for sample[-1] in batch: [0.05676, 0.55905, 0.00171, 0.0055, 0.04908, 0.29458, 0.02985, 0.00347]
### reward for the batch: 2
### loss for the batch: 18.56318473815918

Batch: 8
cids for sample[-1] in batch: [1 5]
Cand prob for sample[-1] in batch: [0.13339, 0.34491, 0.00704, 0.0226, 0.02538, 0.42165, 0.04157, 0.00346]
### reward for the batch: 2
### loss for the batch: 5.356966495513916

Batch: 9
cids for sample[-1] in batch: [5 0]
Cand prob for sample[-1] in batch: [0.08256, 0.25485, 0.00994, 0.02624, 0.01535, 0.55847, 0.04851, 0.00408]
### reward for the batch: 2
### loss for the batch: 13.316484451293945

============================================
### Epoch: 6 / 20
### Total reward: 18, Total loss: 121.33706, Best reward: 18 at epoch 0, Best loss: 108.4511 at epoch 3

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_6.pt
============================================

Epoch: 7
Batch: 0
cids for sample[-1] in batch: [1 5]
Cand prob for sample[-1] in batch: [0.10341, 0.12648, 0.01552, 0.0613, 0.00913, 0.63552, 0.04517, 0.00346]
### reward for the batch: 2
### loss for the batch: 11.28852367401123

Batch: 1
cids for sample[-1] in batch: [5 2]
Cand prob for sample[-1] in batch: [0.19379, 0.1145, 0.05228, 0.10514, 0.00748, 0.4363, 0.08313, 0.00738]
### reward for the batch: 2
### loss for the batch: 14.185687065124512

Batch: 2
cids for sample[-1] in batch: [2 5]
Cand prob for sample[-1] in batch: [0.27555, 0.06761, 0.12728, 0.20448, 0.0127, 0.17717, 0.11302, 0.02218]
### reward for the batch: 0
### loss for the batch: -1.003988265991211

Batch: 3
cids for sample[-1] in batch: [3 5]
Cand prob for sample[-1] in batch: [0.19497, 0.07075, 0.10796, 0.23815, 0.01166, 0.25456, 0.10939, 0.01255]
### reward for the batch: 2
### loss for the batch: 9.574186325073242

Batch: 4
cids for sample[-1] in batch: [2 1]
Cand prob for sample[-1] in batch: [0.14907, 0.06503, 0.21556, 0.22665, 0.02015, 0.12433, 0.1624, 0.03679]
### reward for the batch: 2
### loss for the batch: 14.856618881225586

Batch: 5
cids for sample[-1] in batch: [2 3]
Cand prob for sample[-1] in batch: [0.12537, 0.06822, 0.24514, 0.17068, 0.03129, 0.08541, 0.20994, 0.06395]
### reward for the batch: 2
### loss for the batch: 14.796598434448242

Batch: 6
cids for sample[-1] in batch: [0 2]
Cand prob for sample[-1] in batch: [0.10265, 0.07789, 0.23264, 0.14524, 0.04858, 0.05031, 0.22101, 0.12168]
### reward for the batch: 2
### loss for the batch: 12.896888732910156

Batch: 7
cids for sample[-1] in batch: [4 6]
Cand prob for sample[-1] in batch: [0.05941, 0.06876, 0.12512, 0.10035, 0.13334, 0.02581, 0.17899, 0.30822]
### reward for the batch: 2
### loss for the batch: 13.572704315185547

Batch: 8
cids for sample[-1] in batch: [3 1]
Cand prob for sample[-1] in batch: [0.04717, 0.0629, 0.12768, 0.0977, 0.15343, 0.01109, 0.18287, 0.31717]
### reward for the batch: 2
### loss for the batch: 13.137216567993164

Batch: 9
cids for sample[-1] in batch: [4 6]
Cand prob for sample[-1] in batch: [0.02617, 0.08208, 0.09021, 0.06974, 0.17245, 0.00849, 0.20415, 0.34672]
### reward for the batch: 2
### loss for the batch: 9.909581184387207

============================================
### Epoch: 7 / 20
### Total reward: 18, Total loss: 113.21402, Best reward: 18 at epoch 0, Best loss: 108.4511 at epoch 3

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_7.pt
============================================

Epoch: 8
Batch: 0
cids for sample[-1] in batch: [2 3]
Cand prob for sample[-1] in batch: [0.03552, 0.12345, 0.13746, 0.16443, 0.13179, 0.02607, 0.23904, 0.14224]
### reward for the batch: 2
### loss for the batch: 11.254631996154785

Batch: 1
cids for sample[-1] in batch: [3 6]
Cand prob for sample[-1] in batch: [0.02415, 0.11957, 0.19938, 0.15831, 0.12027, 0.01401, 0.21478, 0.14952]
### reward for the batch: 2
### loss for the batch: 11.432929992675781

Batch: 2
cids for sample[-1] in batch: [1 2]
Cand prob for sample[-1] in batch: [0.02363, 0.07375, 0.17912, 0.36512, 0.10161, 0.01278, 0.14002, 0.10396]
### reward for the batch: 0
### loss for the batch: -0.22975969314575195

Batch: 3
cids for sample[-1] in batch: [2 3]
Cand prob for sample[-1] in batch: [0.02393, 0.03905, 0.08198, 0.67528, 0.03206, 0.03249, 0.09422, 0.02099]
### reward for the batch: 2
### loss for the batch: 9.998296737670898

Batch: 4
cids for sample[-1] in batch: [0 1]
Cand prob for sample[-1] in batch: [0.01543, 0.04644, 0.14215, 0.6604, 0.01432, 0.03347, 0.07718, 0.0106]
### reward for the batch: 2
### loss for the batch: 17.092453002929688

Batch: 5
cids for sample[-1] in batch: [3 5]
Cand prob for sample[-1] in batch: [0.02238, 0.05486, 0.15439, 0.606, 0.0145, 0.05905, 0.07948, 0.00933]
### reward for the batch: 2
### loss for the batch: 14.417717933654785

Batch: 6
cids for sample[-1] in batch: [5 7]
Cand prob for sample[-1] in batch: [0.03332, 0.05024, 0.15629, 0.55426, 0.00703, 0.13081, 0.06373, 0.00432]
### reward for the batch: 2
### loss for the batch: 26.111507415771484

Batch: 7
cids for sample[-1] in batch: [3 0]
Cand prob for sample[-1] in batch: [0.06831, 0.05666, 0.08381, 0.31424, 0.04367, 0.3117, 0.0985, 0.02311]
### reward for the batch: 2
### loss for the batch: 11.398741722106934

Batch: 8
cids for sample[-1] in batch: [3 4]
Cand prob for sample[-1] in batch: [0.07899, 0.06049, 0.08138, 0.28258, 0.0502, 0.33226, 0.08324, 0.03086]
### reward for the batch: 2
### loss for the batch: 16.098447799682617

Batch: 9
cids for sample[-1] in batch: [4 6]
Cand prob for sample[-1] in batch: [0.09951, 0.05814, 0.04813, 0.08431, 0.23752, 0.20911, 0.13333, 0.12994]
### reward for the batch: 2
### loss for the batch: 10.761126518249512

============================================
### Epoch: 8 / 20
### Total reward: 18, Total loss: 128.33609, Best reward: 18 at epoch 0, Best loss: 108.4511 at epoch 3

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_8.pt
============================================

Epoch: 9
Batch: 0
cids for sample[-1] in batch: [4 5]
Cand prob for sample[-1] in batch: [0.09895, 0.06394, 0.05486, 0.05559, 0.26959, 0.17647, 0.14393, 0.13668]
### reward for the batch: 2
### loss for the batch: 13.436568260192871

Batch: 1
cids for sample[-1] in batch: [6 1]
Cand prob for sample[-1] in batch: [0.05517, 0.04307, 0.03606, 0.01858, 0.48238, 0.04402, 0.09746, 0.22327]
### reward for the batch: 2
### loss for the batch: 13.984600067138672

Batch: 2
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.07963, 0.04797, 0.04776, 0.0152, 0.47126, 0.02837, 0.0932, 0.21661]
### reward for the batch: 0
### loss for the batch: -0.28040218353271484

Batch: 3
cids for sample[-1] in batch: [0 4]
Cand prob for sample[-1] in batch: [0.1037, 0.02417, 0.02346, 0.00581, 0.56155, 0.01429, 0.10611, 0.16091]
### reward for the batch: 2
### loss for the batch: 10.535327911376953

Batch: 4
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.0941, 0.03355, 0.03114, 0.00228, 0.52115, 0.00388, 0.11853, 0.19537]
### reward for the batch: 2
### loss for the batch: 15.219346046447754

Batch: 5
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.18032, 0.0474, 0.07327, 0.00393, 0.28888, 0.00648, 0.18872, 0.21099]
### reward for the batch: 2
### loss for the batch: 14.393566131591797

Batch: 6
cids for sample[-1] in batch: [5 2]
Cand prob for sample[-1] in batch: [0.39956, 0.05032, 0.15543, 0.00444, 0.05565, 0.00611, 0.17892, 0.14957]
### reward for the batch: 2
### loss for the batch: 19.213668823242188

Batch: 7
cids for sample[-1] in batch: [6 2]
Cand prob for sample[-1] in batch: [0.36566, 0.05829, 0.2624, 0.00828, 0.02579, 0.01276, 0.15823, 0.10858]
### reward for the batch: 2
### loss for the batch: 8.975698471069336

Batch: 8
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.34142, 0.07212, 0.30238, 0.02189, 0.01488, 0.0201, 0.10533, 0.12189]
### reward for the batch: 2
### loss for the batch: 10.572698593139648

Batch: 9
cids for sample[-1] in batch: [2 0]
Cand prob for sample[-1] in batch: [0.36919, 0.05481, 0.36419, 0.01633, 0.0039, 0.01939, 0.10049, 0.0717]
### reward for the batch: 2
### loss for the batch: 13.730051040649414

============================================
### Epoch: 9 / 20
### Total reward: 18, Total loss: 119.78112, Best reward: 18 at epoch 0, Best loss: 108.4511 at epoch 3

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_9.pt
============================================

Epoch: 10
Batch: 0
cids for sample[-1] in batch: [4 2]
Cand prob for sample[-1] in batch: [0.40359, 0.04788, 0.3818, 0.03187, 0.0012, 0.02797, 0.07424, 0.03145]
### reward for the batch: 2
### loss for the batch: 13.423423767089844

Batch: 1
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.27946, 0.0627, 0.45769, 0.06789, 0.00118, 0.02932, 0.06296, 0.03881]
### reward for the batch: 2
### loss for the batch: 14.799139022827148

Batch: 2
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.3358, 0.06799, 0.29588, 0.10846, 0.0047, 0.0388, 0.05009, 0.0983]
### reward for the batch: 0
### loss for the batch: 3.693425178527832

Batch: 3
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.36518, 0.05253, 0.18168, 0.10131, 0.01649, 0.06796, 0.05945, 0.15539]
### reward for the batch: 2
### loss for the batch: 13.140487670898438

Batch: 4
cids for sample[-1] in batch: [7 1]
Cand prob for sample[-1] in batch: [0.23354, 0.06439, 0.12616, 0.08575, 0.02947, 0.05658, 0.05163, 0.35246]
### reward for the batch: 2
### loss for the batch: 13.029372215270996

Batch: 5
cids for sample[-1] in batch: [2 4]
Cand prob for sample[-1] in batch: [0.12874, 0.06406, 0.05578, 0.07583, 0.07162, 0.07496, 0.04586, 0.48316]
### reward for the batch: 2
### loss for the batch: 12.867770195007324

Batch: 6
cids for sample[-1] in batch: [3 0]
Cand prob for sample[-1] in batch: [0.1112, 0.06359, 0.04602, 0.08285, 0.09243, 0.08083, 0.04061, 0.48246]
### reward for the batch: 2
### loss for the batch: 10.704429626464844

Batch: 7
cids for sample[-1] in batch: [1 7]
Cand prob for sample[-1] in batch: [0.08518, 0.06716, 0.04157, 0.06081, 0.20567, 0.06945, 0.04749, 0.42267]
### reward for the batch: 2
### loss for the batch: 11.140180587768555

Batch: 8
cids for sample[-1] in batch: [1 7]
Cand prob for sample[-1] in batch: [0.03277, 0.05975, 0.00968, 0.0648, 0.37086, 0.03397, 0.02736, 0.4008]
### reward for the batch: 2
### loss for the batch: 13.173149108886719

Batch: 9
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.04306, 0.12004, 0.03562, 0.06498, 0.34963, 0.06309, 0.0711, 0.25249]
### reward for the batch: 2
### loss for the batch: 10.578944206237793

============================================
### Epoch: 10 / 20
### Total reward: 18, Total loss: 116.55032, Best reward: 18 at epoch 0, Best loss: 108.4511 at epoch 3

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_10.pt
============================================

Epoch: 11
Batch: 0
cids for sample[-1] in batch: [5 2]
Cand prob for sample[-1] in batch: [0.04488, 0.17816, 0.0464, 0.10605, 0.25801, 0.10312, 0.11615, 0.14723]
### reward for the batch: 2
### loss for the batch: 13.410554885864258

Batch: 1
cids for sample[-1] in batch: [2 3]
Cand prob for sample[-1] in batch: [0.03379, 0.17811, 0.03002, 0.17812, 0.19132, 0.12051, 0.11938, 0.14875]
### reward for the batch: 2
### loss for the batch: 14.705642700195312

Batch: 2
cids for sample[-1] in batch: [1 4]
Cand prob for sample[-1] in batch: [0.04312, 0.1514, 0.04579, 0.16478, 0.23996, 0.09216, 0.11343, 0.14937]
### reward for the batch: 0
### loss for the batch: -1.4723801612854004

Batch: 3
cids for sample[-1] in batch: [6 2]
Cand prob for sample[-1] in batch: [0.05688, 0.15019, 0.16878, 0.09079, 0.16696, 0.1167, 0.19322, 0.05646]
### reward for the batch: 2
### loss for the batch: 12.69836711883545

Batch: 4
cids for sample[-1] in batch: [4 6]
Cand prob for sample[-1] in batch: [0.03017, 0.16999, 0.2248, 0.06188, 0.1563, 0.11848, 0.19224, 0.04614]
### reward for the batch: 2
### loss for the batch: 13.766242980957031

Batch: 5
cids for sample[-1] in batch: [4 5]
Cand prob for sample[-1] in batch: [0.03427, 0.10716, 0.23846, 0.06857, 0.14829, 0.16346, 0.19514, 0.04466]
### reward for the batch: 2
### loss for the batch: 12.385807037353516

Batch: 6
cids for sample[-1] in batch: [3 1]
Cand prob for sample[-1] in batch: [0.04991, 0.07348, 0.2651, 0.08969, 0.11807, 0.19829, 0.16477, 0.0407]
### reward for the batch: 2
### loss for the batch: 12.291241645812988

Batch: 7
cids for sample[-1] in batch: [6 4]
Cand prob for sample[-1] in batch: [0.04855, 0.07209, 0.38038, 0.04271, 0.11524, 0.15145, 0.15355, 0.03603]
### reward for the batch: 2
### loss for the batch: 13.13770866394043

Batch: 8
cids for sample[-1] in batch: [4 6]
Cand prob for sample[-1] in batch: [0.05069, 0.08527, 0.22252, 0.09386, 0.20002, 0.12615, 0.15421, 0.06728]
### reward for the batch: 2
### loss for the batch: 10.65266227722168

Batch: 9
cids for sample[-1] in batch: [7 2]
Cand prob for sample[-1] in batch: [0.04238, 0.08634, 0.38844, 0.02234, 0.17319, 0.0812, 0.16659, 0.03952]
### reward for the batch: 2
### loss for the batch: 12.31889820098877

============================================
### Epoch: 11 / 20
### Total reward: 18, Total loss: 113.89475, Best reward: 18 at epoch 0, Best loss: 108.4511 at epoch 3

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_11.pt
============================================

Epoch: 12
Batch: 0
cids for sample[-1] in batch: [2 6]
Cand prob for sample[-1] in batch: [0.05105, 0.09751, 0.33032, 0.0334, 0.18074, 0.09925, 0.17004, 0.03769]
### reward for the batch: 2
### loss for the batch: 11.680309295654297

Batch: 1
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.05148, 0.10309, 0.15555, 0.06917, 0.26375, 0.12472, 0.15234, 0.0799]
### reward for the batch: 2
### loss for the batch: 12.01010513305664

Batch: 2
cids for sample[-1] in batch: [2 4]
Cand prob for sample[-1] in batch: [0.06711, 0.11532, 0.12235, 0.0332, 0.38428, 0.03884, 0.1202, 0.1187]
### reward for the batch: 0
### loss for the batch: -0.16421794891357422

Batch: 3
cids for sample[-1] in batch: [2 0]
Cand prob for sample[-1] in batch: [0.05659, 0.10426, 0.2521, 0.00752, 0.36206, 0.02614, 0.12696, 0.06437]
### reward for the batch: 2
### loss for the batch: 14.576635360717773

Batch: 4
cids for sample[-1] in batch: [2 4]
Cand prob for sample[-1] in batch: [0.03568, 0.14162, 0.21787, 0.0082, 0.38052, 0.03534, 0.09303, 0.08773]
### reward for the batch: 2
### loss for the batch: 12.89858341217041

Batch: 5
cids for sample[-1] in batch: [6 4]
Cand prob for sample[-1] in batch: [0.04388, 0.1299, 0.19171, 0.01034, 0.37304, 0.05304, 0.08552, 0.11256]
### reward for the batch: 2
### loss for the batch: 12.400581359863281

Batch: 6
cids for sample[-1] in batch: [1 2]
Cand prob for sample[-1] in batch: [0.09927, 0.14248, 0.21644, 0.02595, 0.24458, 0.05933, 0.10367, 0.10828]
### reward for the batch: 2
### loss for the batch: 11.802412033081055

Batch: 7
cids for sample[-1] in batch: [6 1]
Cand prob for sample[-1] in batch: [0.11338, 0.1639, 0.33442, 0.01044, 0.16572, 0.0259, 0.11835, 0.06789]
### reward for the batch: 2
### loss for the batch: 13.859600067138672

Batch: 8
cids for sample[-1] in batch: [6 2]
Cand prob for sample[-1] in batch: [0.13643, 0.20669, 0.27066, 0.02334, 0.13854, 0.01551, 0.13096, 0.07787]
### reward for the batch: 2
### loss for the batch: 11.393616676330566

Batch: 9
cids for sample[-1] in batch: [7 6]
Cand prob for sample[-1] in batch: [0.13304, 0.19752, 0.34996, 0.01054, 0.08692, 0.01862, 0.14115, 0.06223]
### reward for the batch: 2
### loss for the batch: 16.142337799072266

============================================
### Epoch: 12 / 20
### Total reward: 18, Total loss: 116.59996, Best reward: 18 at epoch 0, Best loss: 108.4511 at epoch 3

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_12.pt
============================================

Epoch: 13
Batch: 0
cids for sample[-1] in batch: [7 1]
Cand prob for sample[-1] in batch: [0.14655, 0.198, 0.30968, 0.02476, 0.05289, 0.05242, 0.17086, 0.04484]
### reward for the batch: 2
### loss for the batch: 11.816534996032715

Batch: 1
cids for sample[-1] in batch: [0 4]
Cand prob for sample[-1] in batch: [0.15155, 0.19053, 0.18669, 0.06793, 0.06751, 0.0849, 0.166, 0.08488]
### reward for the batch: 2
### loss for the batch: 10.423627853393555

Batch: 2
cids for sample[-1] in batch: [5 1]
Cand prob for sample[-1] in batch: [0.17595, 0.22751, 0.1651, 0.04733, 0.06393, 0.05287, 0.18028, 0.08702]
### reward for the batch: 0
### loss for the batch: -1.5062971115112305

Batch: 3
cids for sample[-1] in batch: [1 2]
Cand prob for sample[-1] in batch: [0.14481, 0.21244, 0.23567, 0.02358, 0.04287, 0.0736, 0.21051, 0.05651]
### reward for the batch: 2
### loss for the batch: 11.86673641204834

Batch: 4
cids for sample[-1] in batch: [0 2]
Cand prob for sample[-1] in batch: [0.0719, 0.28199, 0.26518, 0.02751, 0.04508, 0.08121, 0.1724, 0.05473]
### reward for the batch: 2
### loss for the batch: 13.045156478881836

Batch: 5
cids for sample[-1] in batch: [6 2]
Cand prob for sample[-1] in batch: [0.07211, 0.24611, 0.2674, 0.02205, 0.04646, 0.11215, 0.17652, 0.0572]
### reward for the batch: 2
### loss for the batch: 11.488227844238281

Batch: 6
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.10125, 0.23136, 0.24031, 0.04204, 0.04913, 0.1217, 0.15973, 0.05448]
### reward for the batch: 2
### loss for the batch: 13.280133247375488

Batch: 7
cids for sample[-1] in batch: [1 5]
Cand prob for sample[-1] in batch: [0.09294, 0.21774, 0.24381, 0.02268, 0.04613, 0.12334, 0.19645, 0.05692]
### reward for the batch: 2
### loss for the batch: 13.075798034667969

Batch: 8
cids for sample[-1] in batch: [2 1]
Cand prob for sample[-1] in batch: [0.10526, 0.19, 0.23986, 0.05419, 0.04808, 0.10184, 0.21194, 0.04883]
### reward for the batch: 2
### loss for the batch: 11.4180908203125

Batch: 9
cids for sample[-1] in batch: [5 7]
Cand prob for sample[-1] in batch: [0.10073, 0.1245, 0.13036, 0.03488, 0.09273, 0.20879, 0.17647, 0.13155]
### reward for the batch: 2
### loss for the batch: 10.806262016296387

============================================
### Epoch: 13 / 20
### Total reward: 18, Total loss: 105.71427, Best reward: 18 at epoch 0, Best loss: 105.71427 at epoch 13

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_13.pt
saved the best loss ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_best_loss.pt
============================================

Epoch: 14
Batch: 0
cids for sample[-1] in batch: [7 2]
Cand prob for sample[-1] in batch: [0.11007, 0.15308, 0.14893, 0.04059, 0.07919, 0.21046, 0.18439, 0.07329]
### reward for the batch: 2
### loss for the batch: 12.861412048339844

Batch: 1
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.13023, 0.11493, 0.09247, 0.09288, 0.1426, 0.16169, 0.14285, 0.12236]
### reward for the batch: 2
### loss for the batch: 12.467615127563477

Batch: 2
cids for sample[-1] in batch: [0 4]
Cand prob for sample[-1] in batch: [0.11059, 0.11791, 0.06581, 0.06519, 0.19234, 0.14862, 0.12995, 0.16959]
### reward for the batch: 0
### loss for the batch: 0.5227885246276855

Batch: 3
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.08592, 0.05309, 0.03558, 0.03593, 0.21631, 0.20961, 0.10396, 0.25961]
### reward for the batch: 2
### loss for the batch: 12.742834091186523

Batch: 4
cids for sample[-1] in batch: [5 0]
Cand prob for sample[-1] in batch: [0.07797, 0.04141, 0.03013, 0.05681, 0.2398, 0.14836, 0.07694, 0.32858]
### reward for the batch: 2
### loss for the batch: 11.22146224975586

Batch: 5
cids for sample[-1] in batch: [7 3]
Cand prob for sample[-1] in batch: [0.09125, 0.03272, 0.02481, 0.0461, 0.22354, 0.19342, 0.08046, 0.30769]
### reward for the batch: 2
### loss for the batch: 10.51821517944336

Batch: 6
cids for sample[-1] in batch: [0 4]
Cand prob for sample[-1] in batch: [0.13732, 0.02375, 0.01048, 0.13725, 0.3361, 0.07089, 0.04341, 0.2408]
### reward for the batch: 2
### loss for the batch: 12.148904800415039

Batch: 7
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.14226, 0.02341, 0.00942, 0.06388, 0.31278, 0.10683, 0.0621, 0.27933]
### reward for the batch: 2
### loss for the batch: 14.885811805725098

Batch: 8
cids for sample[-1] in batch: [3 0]
Cand prob for sample[-1] in batch: [0.19975, 0.04403, 0.01942, 0.18822, 0.30551, 0.04555, 0.07995, 0.11757]
### reward for the batch: 2
### loss for the batch: 13.018163681030273

Batch: 9
cids for sample[-1] in batch: [3 6]
Cand prob for sample[-1] in batch: [0.35961, 0.02354, 0.00902, 0.11303, 0.19819, 0.08028, 0.08402, 0.1323]
### reward for the batch: 2
### loss for the batch: 13.6673583984375

============================================
### Epoch: 14 / 20
### Total reward: 18, Total loss: 114.05457, Best reward: 18 at epoch 0, Best loss: 105.71427 at epoch 13

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_14.pt
============================================

Epoch: 15
Batch: 0
cids for sample[-1] in batch: [0 4]
Cand prob for sample[-1] in batch: [0.45464, 0.04501, 0.01405, 0.16902, 0.1095, 0.0628, 0.10522, 0.03975]
### reward for the batch: 2
### loss for the batch: 12.439909934997559

Batch: 1
cids for sample[-1] in batch: [2 5]
Cand prob for sample[-1] in batch: [0.51744, 0.03644, 0.00744, 0.28698, 0.05827, 0.01681, 0.06368, 0.01295]
### reward for the batch: 2
### loss for the batch: 18.948251724243164

Batch: 2
cids for sample[-1] in batch: [1 4]
Cand prob for sample[-1] in batch: [0.38177, 0.12688, 0.02064, 0.24815, 0.07199, 0.02837, 0.1073, 0.0149]
### reward for the batch: 0
### loss for the batch: -3.4203596115112305

Batch: 3
cids for sample[-1] in batch: [1 3]
Cand prob for sample[-1] in batch: [0.43264, 0.10392, 0.02157, 0.14976, 0.03507, 0.06857, 0.17967, 0.0088]
### reward for the batch: 2
### loss for the batch: 15.44814682006836

Batch: 4
cids for sample[-1] in batch: [3 7]
Cand prob for sample[-1] in batch: [0.28763, 0.16332, 0.05379, 0.24088, 0.04582, 0.05527, 0.1422, 0.01107]
### reward for the batch: 2
### loss for the batch: 13.46573257446289

Batch: 5
cids for sample[-1] in batch: [3 1]
Cand prob for sample[-1] in batch: [0.21508, 0.19643, 0.07507, 0.19215, 0.05688, 0.0801, 0.17213, 0.01216]
### reward for the batch: 2
### loss for the batch: 13.03625202178955

Batch: 6
cids for sample[-1] in batch: [1 0]
Cand prob for sample[-1] in batch: [0.17942, 0.25525, 0.05142, 0.31885, 0.04779, 0.03643, 0.10554, 0.0053]
### reward for the batch: 2
### loss for the batch: 12.86422061920166

Batch: 7
cids for sample[-1] in batch: [1 3]
Cand prob for sample[-1] in batch: [0.12545, 0.29429, 0.0734, 0.12013, 0.09462, 0.08363, 0.18461, 0.02386]
### reward for the batch: 2
### loss for the batch: 10.901298522949219

Batch: 8
cids for sample[-1] in batch: [1 0]
Cand prob for sample[-1] in batch: [0.08331, 0.28622, 0.10914, 0.17802, 0.13237, 0.03093, 0.15427, 0.02576]
### reward for the batch: 2
### loss for the batch: 11.528947830200195

Batch: 9
cids for sample[-1] in batch: [2 1]
Cand prob for sample[-1] in batch: [0.10185, 0.24652, 0.10292, 0.13973, 0.1154, 0.06878, 0.17847, 0.04632]
### reward for the batch: 2
### loss for the batch: 14.111120223999023

============================================
### Epoch: 15 / 20
### Total reward: 18, Total loss: 119.32352, Best reward: 18 at epoch 0, Best loss: 105.71427 at epoch 13

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_15.pt
============================================

Epoch: 16
Batch: 0
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.12182, 0.26867, 0.09968, 0.12378, 0.11624, 0.0809, 0.15402, 0.03491]
### reward for the batch: 2
### loss for the batch: 15.26260757446289

Batch: 1
cids for sample[-1] in batch: [6 1]
Cand prob for sample[-1] in batch: [0.14311, 0.22557, 0.11045, 0.20139, 0.11527, 0.06113, 0.10181, 0.04128]
### reward for the batch: 2
### loss for the batch: 14.093908309936523

Batch: 2
cids for sample[-1] in batch: [2 3]
Cand prob for sample[-1] in batch: [0.13804, 0.16931, 0.1285, 0.14939, 0.15725, 0.05671, 0.082, 0.11879]
### reward for the batch: 0
### loss for the batch: -0.1170964241027832

Batch: 3
cids for sample[-1] in batch: [2 4]
Cand prob for sample[-1] in batch: [0.15508, 0.09918, 0.12134, 0.0968, 0.13433, 0.12829, 0.10799, 0.15699]
### reward for the batch: 2
### loss for the batch: 12.827479362487793

Batch: 4
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.11537, 0.04354, 0.1549, 0.07968, 0.11761, 0.09314, 0.06722, 0.32852]
### reward for the batch: 2
### loss for the batch: 11.079007148742676

Batch: 5
cids for sample[-1] in batch: [2 4]
Cand prob for sample[-1] in batch: [0.09892, 0.0289, 0.13766, 0.04701, 0.11166, 0.10576, 0.07268, 0.39742]
### reward for the batch: 2
### loss for the batch: 13.616012573242188

Batch: 6
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.11083, 0.03558, 0.11242, 0.05235, 0.14873, 0.08704, 0.05523, 0.39782]
### reward for the batch: 2
### loss for the batch: 10.715911865234375

Batch: 7
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.07144, 0.01938, 0.0917, 0.01743, 0.11424, 0.08839, 0.05649, 0.54093]
### reward for the batch: 2
### loss for the batch: 13.957854270935059

Batch: 8
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.06898, 0.01271, 0.11251, 0.02596, 0.11961, 0.05297, 0.05966, 0.54759]
### reward for the batch: 2
### loss for the batch: 13.180295944213867

Batch: 9
cids for sample[-1] in batch: [5 3]
Cand prob for sample[-1] in batch: [0.0677, 0.01832, 0.13677, 0.03055, 0.13238, 0.0965, 0.10127, 0.41651]
### reward for the batch: 2
### loss for the batch: 17.006040573120117

============================================
### Epoch: 16 / 20
### Total reward: 18, Total loss: 121.62202, Best reward: 18 at epoch 0, Best loss: 105.71427 at epoch 13

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_16.pt
============================================

Epoch: 17
Batch: 0
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.10512, 0.0316, 0.13701, 0.05027, 0.1386, 0.18981, 0.14567, 0.20193]
### reward for the batch: 2
### loss for the batch: 13.036598205566406

Batch: 1
cids for sample[-1] in batch: [3 7]
Cand prob for sample[-1] in batch: [0.10624, 0.0471, 0.15405, 0.09364, 0.12968, 0.16303, 0.14521, 0.16106]
### reward for the batch: 2
### loss for the batch: 12.292972564697266

Batch: 2
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.12125, 0.0467, 0.1608, 0.16346, 0.12705, 0.10428, 0.10226, 0.1742]
### reward for the batch: 0
### loss for the batch: -0.7228708267211914

Batch: 3
cids for sample[-1] in batch: [7 3]
Cand prob for sample[-1] in batch: [0.12977, 0.05435, 0.13538, 0.13927, 0.1313, 0.17237, 0.13907, 0.09848]
### reward for the batch: 2
### loss for the batch: 11.780294418334961

Batch: 4
cids for sample[-1] in batch: [2 3]
Cand prob for sample[-1] in batch: [0.10529, 0.05168, 0.15444, 0.20315, 0.08299, 0.15246, 0.12809, 0.1219]
### reward for the batch: 2
### loss for the batch: 11.081377983093262

Batch: 5
cids for sample[-1] in batch: [1 3]
Cand prob for sample[-1] in batch: [0.11759, 0.05655, 0.14591, 0.20645, 0.06394, 0.16504, 0.15123, 0.09329]
### reward for the batch: 2
### loss for the batch: 12.09090805053711

Batch: 6
cids for sample[-1] in batch: [5 4]
Cand prob for sample[-1] in batch: [0.12959, 0.08702, 0.11584, 0.23885, 0.09592, 0.11362, 0.10574, 0.1134]
### reward for the batch: 2
### loss for the batch: 12.613120079040527

Batch: 7
cids for sample[-1] in batch: [7 6]
Cand prob for sample[-1] in batch: [0.14974, 0.09503, 0.09935, 0.23465, 0.0583, 0.13196, 0.14159, 0.08938]
### reward for the batch: 2
### loss for the batch: 11.957683563232422

Batch: 8
cids for sample[-1] in batch: [7 3]
Cand prob for sample[-1] in batch: [0.15492, 0.06268, 0.0937, 0.30301, 0.03717, 0.08042, 0.17291, 0.0952]
### reward for the batch: 2
### loss for the batch: 12.11972427368164

Batch: 9
cids for sample[-1] in batch: [5 2]
Cand prob for sample[-1] in batch: [0.10746, 0.13548, 0.09176, 0.22123, 0.05528, 0.06668, 0.18717, 0.13494]
### reward for the batch: 2
### loss for the batch: 13.979133605957031

============================================
### Epoch: 17 / 20
### Total reward: 18, Total loss: 110.22894, Best reward: 18 at epoch 0, Best loss: 105.71427 at epoch 13

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_17.pt
============================================

Epoch: 18
Batch: 0
cids for sample[-1] in batch: [4 3]
Cand prob for sample[-1] in batch: [0.13797, 0.06539, 0.08486, 0.291, 0.03931, 0.10378, 0.17848, 0.09922]
### reward for the batch: 2
### loss for the batch: 12.978744506835938

Batch: 1
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.09723, 0.09584, 0.1023, 0.27694, 0.04894, 0.07098, 0.16121, 0.14656]
### reward for the batch: 2
### loss for the batch: 12.723584175109863

Batch: 2
cids for sample[-1] in batch: [7 2]
Cand prob for sample[-1] in batch: [0.07613, 0.1519, 0.0895, 0.13659, 0.12199, 0.02226, 0.0932, 0.30843]
### reward for the batch: 0
### loss for the batch: -1.1212105751037598

Batch: 3
cids for sample[-1] in batch: [4 1]
Cand prob for sample[-1] in batch: [0.06417, 0.19813, 0.08459, 0.06264, 0.22436, 0.02666, 0.08884, 0.25062]
### reward for the batch: 2
### loss for the batch: 11.004192352294922

Batch: 4
cids for sample[-1] in batch: [1 7]
Cand prob for sample[-1] in batch: [0.03476, 0.29267, 0.11791, 0.04341, 0.12253, 0.02962, 0.08688, 0.27224]
### reward for the batch: 2
### loss for the batch: 11.388486862182617

Batch: 5
cids for sample[-1] in batch: [1 3]
Cand prob for sample[-1] in batch: [0.03199, 0.34875, 0.11672, 0.02878, 0.10415, 0.0331, 0.09265, 0.24387]
### reward for the batch: 2
### loss for the batch: 14.723064422607422

Batch: 6
cids for sample[-1] in batch: [1 4]
Cand prob for sample[-1] in batch: [0.02698, 0.4106, 0.09378, 0.01641, 0.15133, 0.02456, 0.0544, 0.22194]
### reward for the batch: 2
### loss for the batch: 13.587929725646973

Batch: 7
cids for sample[-1] in batch: [4 1]
Cand prob for sample[-1] in batch: [0.05418, 0.33984, 0.13243, 0.04998, 0.0849, 0.07473, 0.09569, 0.16826]
### reward for the batch: 2
### loss for the batch: 14.463875770568848

Batch: 8
cids for sample[-1] in batch: [3 1]
Cand prob for sample[-1] in batch: [0.06298, 0.16484, 0.18571, 0.19051, 0.04832, 0.12688, 0.09483, 0.12593]
### reward for the batch: 2
### loss for the batch: 12.389945983886719

Batch: 9
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.04558, 0.20782, 0.19597, 0.1812, 0.04005, 0.18441, 0.08025, 0.06472]
### reward for the batch: 2
### loss for the batch: 13.447227478027344

============================================
### Epoch: 18 / 20
### Total reward: 18, Total loss: 115.58584, Best reward: 18 at epoch 0, Best loss: 105.71427 at epoch 13

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_18.pt
============================================

Epoch: 19
Batch: 0
cids for sample[-1] in batch: [3 5]
Cand prob for sample[-1] in batch: [0.0387, 0.01551, 0.05584, 0.63439, 0.00736, 0.18441, 0.04899, 0.01479]
### reward for the batch: 2
### loss for the batch: 10.59307861328125

Batch: 1
cids for sample[-1] in batch: [3 5]
Cand prob for sample[-1] in batch: [0.0227, 0.00705, 0.03745, 0.69647, 0.00219, 0.18881, 0.03863, 0.0067]
### reward for the batch: 2
### loss for the batch: 14.77705192565918

Batch: 2
cids for sample[-1] in batch: [5 3]
Cand prob for sample[-1] in batch: [0.03401, 0.00967, 0.04527, 0.70091, 0.00831, 0.14621, 0.03804, 0.01758]
### reward for the batch: 0
### loss for the batch: -2.7190604209899902

Batch: 3
cids for sample[-1] in batch: [1 5]
Cand prob for sample[-1] in batch: [0.10428, 0.03108, 0.05112, 0.29783, 0.06879, 0.3, 0.11595, 0.03095]
### reward for the batch: 2
### loss for the batch: 12.06521987915039

Batch: 4
cids for sample[-1] in batch: [0 2]
Cand prob for sample[-1] in batch: [0.08136, 0.01493, 0.02909, 0.15447, 0.01311, 0.57101, 0.12454, 0.0115]
### reward for the batch: 2
### loss for the batch: 18.153635025024414

Batch: 5
cids for sample[-1] in batch: [4 7]
Cand prob for sample[-1] in batch: [0.13214, 0.02598, 0.02772, 0.08604, 0.02713, 0.48935, 0.19824, 0.0134]
### reward for the batch: 2
### loss for the batch: 16.605960845947266

Batch: 6
cids for sample[-1] in batch: [4 6]
Cand prob for sample[-1] in batch: [0.15668, 0.11637, 0.0263, 0.01316, 0.34893, 0.10859, 0.19688, 0.03308]
### reward for the batch: 2
### loss for the batch: 12.533337593078613

Batch: 7
cids for sample[-1] in batch: [3 1]
Cand prob for sample[-1] in batch: [0.12349, 0.16541, 0.02101, 0.00429, 0.46159, 0.02324, 0.16513, 0.03584]
### reward for the batch: 2
### loss for the batch: 14.688213348388672

Batch: 8
cids for sample[-1] in batch: [4 3]
Cand prob for sample[-1] in batch: [0.10824, 0.26306, 0.03306, 0.00518, 0.37646, 0.01853, 0.15898, 0.03651]
### reward for the batch: 2
### loss for the batch: 16.9454402923584

Batch: 9
cids for sample[-1] in batch: [4 1]
Cand prob for sample[-1] in batch: [0.06933, 0.38272, 0.03739, 0.00176, 0.36099, 0.01016, 0.10836, 0.02928]
### reward for the batch: 2
### loss for the batch: 11.360639572143555

============================================
### Epoch: 19 / 20
### Total reward: 18, Total loss: 125.00352, Best reward: 18 at epoch 0, Best loss: 105.71427 at epoch 13

saved the ckpt to checkpoints/exp0_autopot_0.1randompolicy/ckpt_19.pt
============================================

