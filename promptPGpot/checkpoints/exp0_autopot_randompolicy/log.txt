Epoch: 0
Batch: 0
cids for sample[-1] in batch: [5 3]
Cand prob for sample[-1] in batch: [0.1084, 0.13855, 0.10379, 0.13392, 0.11538, 0.10999, 0.14534, 0.14462]
### reward for the batch: 2
### loss for the batch: 8.963153839111328

Batch: 1
cids for sample[-1] in batch: [5 7]
Cand prob for sample[-1] in batch: [0.05007, 0.0233, 0.07373, 0.07612, 0.02732, 0.57955, 0.04548, 0.12443]
### reward for the batch: 2
### loss for the batch: 5.752099514007568

Batch: 2
cids for sample[-1] in batch: [2 5]
Cand prob for sample[-1] in batch: [0.01926, 0.00913, 0.1611, 0.02543, 0.0147, 0.53744, 0.02154, 0.2114]
### reward for the batch: 0
### loss for the batch: 1.6458735466003418

Batch: 3
cids for sample[-1] in batch: [7 2]
Cand prob for sample[-1] in batch: [0.01484, 0.01331, 0.59061, 0.00641, 0.02234, 0.14815, 0.0294, 0.17494]
### reward for the batch: 2
### loss for the batch: 12.679627418518066

Batch: 4
cids for sample[-1] in batch: [7 2]
Cand prob for sample[-1] in batch: [0.01408, 0.01323, 0.51648, 0.00539, 0.02427, 0.09857, 0.06816, 0.25981]
### reward for the batch: 2
### loss for the batch: 5.482828140258789

Batch: 5
cids for sample[-1] in batch: [7 6]
Cand prob for sample[-1] in batch: [0.02249, 0.02039, 0.27854, 0.0062, 0.03869, 0.08146, 0.2165, 0.33573]
### reward for the batch: 2
### loss for the batch: 9.50975227355957

Batch: 6
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.03055, 0.02959, 0.17408, 0.01521, 0.03635, 0.08754, 0.36608, 0.26059]
### reward for the batch: 2
### loss for the batch: 6.754325866699219

Batch: 7
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.0276, 0.02039, 0.03196, 0.0148, 0.0637, 0.04762, 0.44698, 0.34697]
### reward for the batch: 2
### loss for the batch: 10.286090850830078

Batch: 8
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.05802, 0.04857, 0.02184, 0.02645, 0.09959, 0.0226, 0.62751, 0.09543]
### reward for the batch: 2
### loss for the batch: 9.94443130493164

Batch: 9
cids for sample[-1] in batch: [4 0]
Cand prob for sample[-1] in batch: [0.12049, 0.05144, 0.03617, 0.0496, 0.1428, 0.04851, 0.45219, 0.09879]
### reward for the batch: 2
### loss for the batch: 11.064565658569336

============================================
### Epoch: 0 / 20
### Total reward: 18, Total loss: 82.08275, Best reward: 18 at epoch 0, Best loss: 82.08275 at epoch 0

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_0.pt
saved the best reward ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_best_reward.pt
saved the best loss ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_best_loss.pt
============================================

Epoch: 1
Batch: 0
cids for sample[-1] in batch: [3 6]
Cand prob for sample[-1] in batch: [0.14864, 0.04384, 0.095, 0.13092, 0.1054, 0.10415, 0.32586, 0.04618]
### reward for the batch: 2
### loss for the batch: 9.74858570098877

Batch: 1
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.163, 0.05828, 0.18708, 0.2236, 0.08532, 0.0874, 0.17291, 0.02242]
### reward for the batch: 2
### loss for the batch: 8.94791030883789

Batch: 2
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.15196, 0.06282, 0.21758, 0.24076, 0.07247, 0.1081, 0.12139, 0.02493]
### reward for the batch: 0
### loss for the batch: 0.3493227958679199

Batch: 3
cids for sample[-1] in batch: [0 3]
Cand prob for sample[-1] in batch: [0.19135, 0.10544, 0.07194, 0.16776, 0.22058, 0.10203, 0.09827, 0.04262]
### reward for the batch: 2
### loss for the batch: 9.361635208129883

Batch: 4
cids for sample[-1] in batch: [5 3]
Cand prob for sample[-1] in batch: [0.15429, 0.06669, 0.16508, 0.18533, 0.14313, 0.16234, 0.07015, 0.053]
### reward for the batch: 2
### loss for the batch: 8.401232719421387

Batch: 5
cids for sample[-1] in batch: [4 3]
Cand prob for sample[-1] in batch: [0.17658, 0.06626, 0.10698, 0.16187, 0.17956, 0.19678, 0.06177, 0.05019]
### reward for the batch: 2
### loss for the batch: 8.918097496032715

Batch: 6
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.14539, 0.13989, 0.06068, 0.0864, 0.40393, 0.06419, 0.05915, 0.04036]
### reward for the batch: 2
### loss for the batch: 10.134055137634277

Batch: 7
cids for sample[-1] in batch: [7 6]
Cand prob for sample[-1] in batch: [0.15946, 0.12077, 0.07164, 0.07191, 0.29883, 0.10999, 0.06837, 0.09902]
### reward for the batch: 2
### loss for the batch: 9.376155853271484

Batch: 8
cids for sample[-1] in batch: [7 2]
Cand prob for sample[-1] in batch: [0.11303, 0.16331, 0.13093, 0.04687, 0.26603, 0.08937, 0.07064, 0.11981]
### reward for the batch: 2
### loss for the batch: 8.01458740234375

Batch: 9
cids for sample[-1] in batch: [2 7]
Cand prob for sample[-1] in batch: [0.0783, 0.15058, 0.14804, 0.03009, 0.13243, 0.12622, 0.05778, 0.27655]
### reward for the batch: 2
### loss for the batch: 9.159810066223145

============================================
### Epoch: 1 / 20
### Total reward: 18, Total loss: 82.41139, Best reward: 18 at epoch 0, Best loss: 82.08275 at epoch 0

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_1.pt
============================================

Epoch: 2
Batch: 0
cids for sample[-1] in batch: [7 5]
Cand prob for sample[-1] in batch: [0.02829, 0.01924, 0.21289, 0.02372, 0.01565, 0.52319, 0.03815, 0.13886]
### reward for the batch: 2
### loss for the batch: 11.129561424255371

Batch: 1
cids for sample[-1] in batch: [2 0]
Cand prob for sample[-1] in batch: [0.03516, 0.03133, 0.33201, 0.02574, 0.01792, 0.35119, 0.04845, 0.15821]
### reward for the batch: 2
### loss for the batch: 8.532137870788574

Batch: 2
cids for sample[-1] in batch: [2 5]
Cand prob for sample[-1] in batch: [0.03125, 0.06497, 0.3942, 0.03201, 0.02166, 0.1973, 0.0582, 0.2004]
### reward for the batch: 0
### loss for the batch: -0.7923078536987305

Batch: 3
cids for sample[-1] in batch: [1 7]
Cand prob for sample[-1] in batch: [0.04557, 0.20695, 0.2059, 0.04537, 0.03651, 0.09396, 0.06323, 0.30252]
### reward for the batch: 2
### loss for the batch: 7.669580936431885

Batch: 4
cids for sample[-1] in batch: [3 2]
Cand prob for sample[-1] in batch: [0.02208, 0.1852, 0.36941, 0.0469, 0.01457, 0.07844, 0.04799, 0.23542]
### reward for the batch: 2
### loss for the batch: 8.500778198242188

Batch: 5
cids for sample[-1] in batch: [7 1]
Cand prob for sample[-1] in batch: [0.0356, 0.28042, 0.26853, 0.09222, 0.02123, 0.06486, 0.0617, 0.17544]
### reward for the batch: 2
### loss for the batch: 8.650028228759766

Batch: 6
cids for sample[-1] in batch: [2 1]
Cand prob for sample[-1] in batch: [0.02675, 0.58024, 0.08516, 0.08193, 0.01985, 0.02455, 0.05517, 0.12635]
### reward for the batch: 2
### loss for the batch: 9.00477409362793

Batch: 7
cids for sample[-1] in batch: [4 1]
Cand prob for sample[-1] in batch: [0.04825, 0.53768, 0.05213, 0.1274, 0.02241, 0.02133, 0.06216, 0.12863]
### reward for the batch: 2
### loss for the batch: 9.812152862548828

Batch: 8
cids for sample[-1] in batch: [6 1]
Cand prob for sample[-1] in batch: [0.03944, 0.64095, 0.0508, 0.12201, 0.0228, 0.00992, 0.04882, 0.06525]
### reward for the batch: 2
### loss for the batch: 10.790821075439453

Batch: 9
cids for sample[-1] in batch: [3 1]
Cand prob for sample[-1] in batch: [0.05427, 0.52932, 0.04082, 0.17263, 0.04249, 0.01582, 0.05662, 0.08804]
### reward for the batch: 2
### loss for the batch: 7.366008758544922

============================================
### Epoch: 2 / 20
### Total reward: 18, Total loss: 80.66354, Best reward: 18 at epoch 0, Best loss: 80.66354 at epoch 2

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_2.pt
saved the best loss ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_best_loss.pt
============================================

Epoch: 3
Batch: 0
cids for sample[-1] in batch: [7 5]
Cand prob for sample[-1] in batch: [0.0481, 0.07677, 0.11109, 0.4021, 0.01895, 0.16734, 0.06371, 0.11195]
### reward for the batch: 2
### loss for the batch: 9.941120147705078

Batch: 1
cids for sample[-1] in batch: [0 5]
Cand prob for sample[-1] in batch: [0.05564, 0.03867, 0.17702, 0.40921, 0.01144, 0.16674, 0.0658, 0.07547]
### reward for the batch: 2
### loss for the batch: 8.868732452392578

Batch: 2
cids for sample[-1] in batch: [3 1]
Cand prob for sample[-1] in batch: [0.06195, 0.02377, 0.19121, 0.33854, 0.01594, 0.20953, 0.07979, 0.07927]
### reward for the batch: 0
### loss for the batch: 0.5484042167663574

Batch: 3
cids for sample[-1] in batch: [7 3]
Cand prob for sample[-1] in batch: [0.11758, 0.04567, 0.09815, 0.25358, 0.05773, 0.15759, 0.09547, 0.17422]
### reward for the batch: 2
### loss for the batch: 7.835177421569824

Batch: 4
cids for sample[-1] in batch: [7 5]
Cand prob for sample[-1] in batch: [0.08642, 0.02388, 0.1617, 0.25114, 0.03178, 0.22569, 0.07099, 0.14841]
### reward for the batch: 2
### loss for the batch: 9.901968955993652

Batch: 5
cids for sample[-1] in batch: [3 5]
Cand prob for sample[-1] in batch: [0.1031, 0.01798, 0.15675, 0.13805, 0.06105, 0.2415, 0.07448, 0.20709]
### reward for the batch: 2
### loss for the batch: 9.88395881652832

Batch: 6
cids for sample[-1] in batch: [7 3]
Cand prob for sample[-1] in batch: [0.09842, 0.02369, 0.14434, 0.09161, 0.09507, 0.20953, 0.09555, 0.24179]
### reward for the batch: 2
### loss for the batch: 7.577536582946777

Batch: 7
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.12588, 0.03086, 0.09433, 0.04175, 0.21983, 0.08587, 0.10263, 0.29885]
### reward for the batch: 2
### loss for the batch: 8.12193775177002

Batch: 8
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.14647, 0.05224, 0.12908, 0.0327, 0.24623, 0.06918, 0.12942, 0.19469]
### reward for the batch: 2
### loss for the batch: 8.077884674072266

Batch: 9
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.17039, 0.05026, 0.09474, 0.02533, 0.31229, 0.04495, 0.09975, 0.20229]
### reward for the batch: 2
### loss for the batch: 10.695597648620605

============================================
### Epoch: 3 / 20
### Total reward: 18, Total loss: 81.45232, Best reward: 18 at epoch 0, Best loss: 80.66354 at epoch 2

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_3.pt
============================================

Epoch: 4
Batch: 0
cids for sample[-1] in batch: [2 7]
Cand prob for sample[-1] in batch: [0.18517, 0.0475, 0.12294, 0.03915, 0.148, 0.10974, 0.10502, 0.24246]
### reward for the batch: 2
### loss for the batch: 9.139822959899902

Batch: 1
cids for sample[-1] in batch: [1 5]
Cand prob for sample[-1] in batch: [0.30538, 0.06282, 0.21496, 0.06328, 0.06036, 0.07567, 0.08724, 0.13029]
### reward for the batch: 2
### loss for the batch: 9.01507568359375

Batch: 2
cids for sample[-1] in batch: [2 6]
Cand prob for sample[-1] in batch: [0.22728, 0.08737, 0.24684, 0.08084, 0.0661, 0.09743, 0.08444, 0.1097]
### reward for the batch: 0
### loss for the batch: 0.13738203048706055

Batch: 3
cids for sample[-1] in batch: [5 4]
Cand prob for sample[-1] in batch: [0.2106, 0.08157, 0.11389, 0.05446, 0.11894, 0.14416, 0.07919, 0.19719]
### reward for the batch: 2
### loss for the batch: 9.073216438293457

Batch: 4
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.16867, 0.11363, 0.16723, 0.08161, 0.08091, 0.1828, 0.06823, 0.13691]
### reward for the batch: 2
### loss for the batch: 9.261929512023926

Batch: 5
cids for sample[-1] in batch: [0 5]
Cand prob for sample[-1] in batch: [0.14402, 0.1028, 0.14245, 0.0683, 0.08013, 0.27601, 0.07346, 0.11281]
### reward for the batch: 2
### loss for the batch: 9.53607177734375

Batch: 6
cids for sample[-1] in batch: [4 0]
Cand prob for sample[-1] in batch: [0.10228, 0.09144, 0.12423, 0.05701, 0.07183, 0.37209, 0.07421, 0.10691]
### reward for the batch: 2
### loss for the batch: 9.153383255004883

Batch: 7
cids for sample[-1] in batch: [7 2]
Cand prob for sample[-1] in batch: [0.11556, 0.09901, 0.09967, 0.05572, 0.11302, 0.30051, 0.09104, 0.12548]
### reward for the batch: 2
### loss for the batch: 9.134035110473633

Batch: 8
cids for sample[-1] in batch: [5 6]
Cand prob for sample[-1] in batch: [0.10415, 0.17049, 0.08258, 0.04987, 0.18371, 0.21908, 0.09522, 0.09491]
### reward for the batch: 2
### loss for the batch: 7.808510780334473

Batch: 9
cids for sample[-1] in batch: [7 6]
Cand prob for sample[-1] in batch: [0.05242, 0.11987, 0.06697, 0.05188, 0.21914, 0.27032, 0.0806, 0.1388]
### reward for the batch: 2
### loss for the batch: 9.0050048828125

============================================
### Epoch: 4 / 20
### Total reward: 18, Total loss: 81.26443, Best reward: 18 at epoch 0, Best loss: 80.66354 at epoch 2

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_4.pt
============================================

Epoch: 5
Batch: 0
cids for sample[-1] in batch: [7 1]
Cand prob for sample[-1] in batch: [0.06292, 0.11977, 0.06054, 0.05088, 0.24325, 0.21594, 0.10444, 0.14225]
### reward for the batch: 2
### loss for the batch: 9.404125213623047

Batch: 1
cids for sample[-1] in batch: [4 5]
Cand prob for sample[-1] in batch: [0.12364, 0.17994, 0.07766, 0.08038, 0.16889, 0.14286, 0.1202, 0.10643]
### reward for the batch: 2
### loss for the batch: 7.648008346557617

Batch: 2
cids for sample[-1] in batch: [4 5]
Cand prob for sample[-1] in batch: [0.08552, 0.15843, 0.09014, 0.09003, 0.14224, 0.17289, 0.14202, 0.11873]
### reward for the batch: 0
### loss for the batch: -0.009311676025390625

Batch: 3
cids for sample[-1] in batch: [6 1]
Cand prob for sample[-1] in batch: [0.05767, 0.06246, 0.03057, 0.03577, 0.17574, 0.22547, 0.13861, 0.27372]
### reward for the batch: 2
### loss for the batch: 8.914502143859863

Batch: 4
cids for sample[-1] in batch: [7 5]
Cand prob for sample[-1] in batch: [0.066, 0.07128, 0.05516, 0.05362, 0.15185, 0.17805, 0.18793, 0.23611]
### reward for the batch: 2
### loss for the batch: 9.518350601196289

Batch: 5
cids for sample[-1] in batch: [2 6]
Cand prob for sample[-1] in batch: [0.08844, 0.06462, 0.05171, 0.04741, 0.15699, 0.15913, 0.21889, 0.2128]
### reward for the batch: 2
### loss for the batch: 8.615029335021973

Batch: 6
cids for sample[-1] in batch: [2 5]
Cand prob for sample[-1] in batch: [0.06799, 0.05195, 0.08264, 0.03958, 0.09363, 0.16179, 0.25991, 0.24251]
### reward for the batch: 2
### loss for the batch: 9.04251766204834

Batch: 7
cids for sample[-1] in batch: [1 4]
Cand prob for sample[-1] in batch: [0.08591, 0.04508, 0.11055, 0.03917, 0.05861, 0.1085, 0.30727, 0.24491]
### reward for the batch: 2
### loss for the batch: 8.425366401672363

Batch: 8
cids for sample[-1] in batch: [0 6]
Cand prob for sample[-1] in batch: [0.14893, 0.05998, 0.15264, 0.06714, 0.02519, 0.11098, 0.26292, 0.17221]
### reward for the batch: 2
### loss for the batch: 6.6054182052612305

Batch: 9
cids for sample[-1] in batch: [2 6]
Cand prob for sample[-1] in batch: [0.06565, 0.04031, 0.27331, 0.06606, 0.01385, 0.08236, 0.21092, 0.24753]
### reward for the batch: 2
### loss for the batch: 8.145490646362305

============================================
### Epoch: 5 / 20
### Total reward: 18, Total loss: 76.3095, Best reward: 18 at epoch 0, Best loss: 76.3095 at epoch 5

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_5.pt
saved the best loss ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_best_loss.pt
============================================

Epoch: 6
Batch: 0
cids for sample[-1] in batch: [2 7]
Cand prob for sample[-1] in batch: [0.07056, 0.05517, 0.33028, 0.06907, 0.01318, 0.0609, 0.21807, 0.18277]
### reward for the batch: 2
### loss for the batch: 9.39780044555664

Batch: 1
cids for sample[-1] in batch: [6 2]
Cand prob for sample[-1] in batch: [0.11163, 0.08545, 0.41316, 0.10951, 0.01009, 0.03897, 0.1386, 0.09259]
### reward for the batch: 2
### loss for the batch: 9.09570026397705

Batch: 2
cids for sample[-1] in batch: [6 2]
Cand prob for sample[-1] in batch: [0.07892, 0.08946, 0.43671, 0.10994, 0.01038, 0.04915, 0.14564, 0.0798]
### reward for the batch: 0
### loss for the batch: -1.760413646697998

Batch: 3
cids for sample[-1] in batch: [2 1]
Cand prob for sample[-1] in batch: [0.09734, 0.07311, 0.34453, 0.08912, 0.01006, 0.06851, 0.1991, 0.11823]
### reward for the batch: 2
### loss for the batch: 7.723791122436523

Batch: 4
cids for sample[-1] in batch: [6 3]
Cand prob for sample[-1] in batch: [0.09088, 0.08817, 0.38497, 0.13287, 0.00611, 0.04842, 0.17666, 0.07192]
### reward for the batch: 0
### loss for the batch: 1.0078773498535156

Batch: 5
cids for sample[-1] in batch: [2 3]
Cand prob for sample[-1] in batch: [0.22211, 0.11192, 0.21915, 0.16529, 0.00879, 0.04189, 0.19662, 0.03423]
### reward for the batch: 2
### loss for the batch: 11.345516204833984

Batch: 6
cids for sample[-1] in batch: [3 2]
Cand prob for sample[-1] in batch: [0.15273, 0.11495, 0.25862, 0.19475, 0.00917, 0.05253, 0.19002, 0.02724]
### reward for the batch: 2
### loss for the batch: 7.030994415283203

Batch: 7
cids for sample[-1] in batch: [2 3]
Cand prob for sample[-1] in batch: [0.17567, 0.11563, 0.18356, 0.18266, 0.01372, 0.07009, 0.23121, 0.02745]
### reward for the batch: 2
### loss for the batch: 7.275522232055664

Batch: 8
cids for sample[-1] in batch: [4 1]
Cand prob for sample[-1] in batch: [0.34275, 0.11006, 0.0911, 0.19413, 0.00946, 0.05098, 0.18905, 0.01248]
### reward for the batch: 2
### loss for the batch: 9.266180038452148

Batch: 9
cids for sample[-1] in batch: [0 6]
Cand prob for sample[-1] in batch: [0.1431, 0.10873, 0.18584, 0.28926, 0.01932, 0.08557, 0.14123, 0.02696]
### reward for the batch: 2
### loss for the batch: 7.630491733551025

============================================
### Epoch: 6 / 20
### Total reward: 16, Total loss: 68.01346, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_6.pt
saved the best loss ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_best_loss.pt
============================================

Epoch: 7
Batch: 0
cids for sample[-1] in batch: [2 3]
Cand prob for sample[-1] in batch: [0.20206, 0.11355, 0.12054, 0.27365, 0.02786, 0.05365, 0.1928, 0.01588]
### reward for the batch: 2
### loss for the batch: 7.864575386047363

Batch: 1
cids for sample[-1] in batch: [6 1]
Cand prob for sample[-1] in batch: [0.4362, 0.10444, 0.04514, 0.21492, 0.03509, 0.02841, 0.12678, 0.00903]
### reward for the batch: 2
### loss for the batch: 8.720789909362793

Batch: 2
cids for sample[-1] in batch: [1 0]
Cand prob for sample[-1] in batch: [0.31623, 0.16155, 0.03761, 0.15663, 0.09654, 0.04194, 0.17222, 0.01728]
### reward for the batch: 0
### loss for the batch: 1.290544033050537

Batch: 3
cids for sample[-1] in batch: [1 7]
Cand prob for sample[-1] in batch: [0.27698, 0.15384, 0.05498, 0.12441, 0.10519, 0.06979, 0.189, 0.02581]
### reward for the batch: 2
### loss for the batch: 8.656082153320312

Batch: 4
cids for sample[-1] in batch: [0 1]
Cand prob for sample[-1] in batch: [0.19945, 0.18119, 0.09318, 0.15995, 0.12987, 0.07025, 0.1335, 0.03261]
### reward for the batch: 2
### loss for the batch: 8.384878158569336

Batch: 5
cids for sample[-1] in batch: [3 6]
Cand prob for sample[-1] in batch: [0.32721, 0.16755, 0.04853, 0.11339, 0.15689, 0.05556, 0.10025, 0.03062]
### reward for the batch: 2
### loss for the batch: 8.796113967895508

Batch: 6
cids for sample[-1] in batch: [0 5]
Cand prob for sample[-1] in batch: [0.23852, 0.18013, 0.06889, 0.16591, 0.1133, 0.09937, 0.09951, 0.03437]
### reward for the batch: 2
### loss for the batch: 6.625218391418457

Batch: 7
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.20331, 0.19078, 0.06431, 0.11671, 0.10263, 0.14462, 0.13178, 0.04586]
### reward for the batch: 2
### loss for the batch: 8.912200927734375

Batch: 8
cids for sample[-1] in batch: [1 5]
Cand prob for sample[-1] in batch: [0.32207, 0.17376, 0.02816, 0.10522, 0.06933, 0.1827, 0.08281, 0.03596]
### reward for the batch: 2
### loss for the batch: 8.349562644958496

Batch: 9
cids for sample[-1] in batch: [2 6]
Cand prob for sample[-1] in batch: [0.11204, 0.16191, 0.098, 0.14025, 0.0646, 0.26913, 0.08828, 0.06579]
### reward for the batch: 2
### loss for the batch: 8.011627197265625

============================================
### Epoch: 7 / 20
### Total reward: 18, Total loss: 75.61159, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_7.pt
============================================

Epoch: 8
Batch: 0
cids for sample[-1] in batch: [5 2]
Cand prob for sample[-1] in batch: [0.06832, 0.11096, 0.17402, 0.22017, 0.03461, 0.26558, 0.09757, 0.02877]
### reward for the batch: 2
### loss for the batch: 7.048919677734375

Batch: 1
cids for sample[-1] in batch: [5 6]
Cand prob for sample[-1] in batch: [0.11307, 0.13551, 0.11167, 0.18755, 0.03948, 0.30307, 0.08103, 0.02861]
### reward for the batch: 2
### loss for the batch: 9.068166732788086

Batch: 2
cids for sample[-1] in batch: [1 7]
Cand prob for sample[-1] in batch: [0.05892, 0.2157, 0.08409, 0.08293, 0.11712, 0.25695, 0.09615, 0.08814]
### reward for the batch: 0
### loss for the batch: -2.937835931777954

Batch: 3
cids for sample[-1] in batch: [2 5]
Cand prob for sample[-1] in batch: [0.03743, 0.15994, 0.23052, 0.0915, 0.05331, 0.25372, 0.14074, 0.03282]
### reward for the batch: 2
### loss for the batch: 7.351992130279541

Batch: 4
cids for sample[-1] in batch: [3 2]
Cand prob for sample[-1] in batch: [0.02832, 0.15821, 0.35211, 0.08449, 0.0436, 0.1998, 0.11526, 0.01821]
### reward for the batch: 2
### loss for the batch: 8.929427146911621

Batch: 5
cids for sample[-1] in batch: [1 3]
Cand prob for sample[-1] in batch: [0.04218, 0.1124, 0.24698, 0.11994, 0.0335, 0.32644, 0.10588, 0.01267]
### reward for the batch: 2
### loss for the batch: 10.32347297668457

Batch: 6
cids for sample[-1] in batch: [5 0]
Cand prob for sample[-1] in batch: [0.03086, 0.07914, 0.24584, 0.1446, 0.01845, 0.37345, 0.09958, 0.00807]
### reward for the batch: 2
### loss for the batch: 8.793303489685059

Batch: 7
cids for sample[-1] in batch: [2 6]
Cand prob for sample[-1] in batch: [0.03521, 0.14335, 0.22399, 0.09713, 0.04, 0.24222, 0.19834, 0.01977]
### reward for the batch: 2
### loss for the batch: 9.058433532714844

Batch: 8
cids for sample[-1] in batch: [6 5]
Cand prob for sample[-1] in batch: [0.05207, 0.19474, 0.09533, 0.12904, 0.03129, 0.3759, 0.10895, 0.01268]
### reward for the batch: 2
### loss for the batch: 11.464179039001465

Batch: 9
cids for sample[-1] in batch: [6 2]
Cand prob for sample[-1] in batch: [0.05491, 0.19815, 0.19444, 0.11832, 0.09252, 0.11705, 0.15591, 0.0687]
### reward for the batch: 2
### loss for the batch: 9.872023582458496

============================================
### Epoch: 8 / 20
### Total reward: 18, Total loss: 78.97208, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_8.pt
============================================

Epoch: 9
Batch: 0
cids for sample[-1] in batch: [2 6]
Cand prob for sample[-1] in batch: [0.05316, 0.11733, 0.24305, 0.21038, 0.04543, 0.11756, 0.18063, 0.03246]
### reward for the batch: 2
### loss for the batch: 7.293600082397461

Batch: 1
cids for sample[-1] in batch: [6 1]
Cand prob for sample[-1] in batch: [0.09315, 0.16213, 0.14701, 0.16446, 0.07104, 0.11984, 0.19607, 0.0463]
### reward for the batch: 2
### loss for the batch: 7.609642505645752

Batch: 2
cids for sample[-1] in batch: [3 4]
Cand prob for sample[-1] in batch: [0.02193, 0.17938, 0.03702, 0.02093, 0.29312, 0.01545, 0.1528, 0.27937]
### reward for the batch: 0
### loss for the batch: 2.414659023284912

Batch: 3
cids for sample[-1] in batch: [6 2]
Cand prob for sample[-1] in batch: [0.04569, 0.22281, 0.1363, 0.06915, 0.14366, 0.01158, 0.25716, 0.11365]
### reward for the batch: 2
### loss for the batch: 9.442699432373047

Batch: 4
cids for sample[-1] in batch: [1 3]
Cand prob for sample[-1] in batch: [0.06579, 0.25237, 0.1339, 0.06675, 0.14304, 0.01241, 0.23522, 0.09053]
### reward for the batch: 2
### loss for the batch: 7.490091800689697

Batch: 5
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.11451, 0.20599, 0.11816, 0.07891, 0.13483, 0.02319, 0.24862, 0.07578]
### reward for the batch: 2
### loss for the batch: 6.666595935821533

Batch: 6
cids for sample[-1] in batch: [2 3]
Cand prob for sample[-1] in batch: [0.13708, 0.2006, 0.12476, 0.1121, 0.09728, 0.02341, 0.25269, 0.05208]
### reward for the batch: 2
### loss for the batch: 7.462707996368408

Batch: 7
cids for sample[-1] in batch: [2 0]
Cand prob for sample[-1] in batch: [0.12845, 0.20043, 0.12671, 0.07754, 0.09295, 0.01014, 0.31397, 0.04981]
### reward for the batch: 2
### loss for the batch: 10.346864700317383

Batch: 8
cids for sample[-1] in batch: [1 3]
Cand prob for sample[-1] in batch: [0.1869, 0.21943, 0.10523, 0.12502, 0.07135, 0.03313, 0.22458, 0.03436]
### reward for the batch: 2
### loss for the batch: 9.686939239501953

Batch: 9
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.16136, 0.1875, 0.12766, 0.08568, 0.14589, 0.0157, 0.19857, 0.07763]
### reward for the batch: 2
### loss for the batch: 6.94200325012207

============================================
### Epoch: 9 / 20
### Total reward: 18, Total loss: 75.3558, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_9.pt
============================================

Epoch: 10
Batch: 0
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.13494, 0.20666, 0.18016, 0.20261, 0.05759, 0.04111, 0.14493, 0.032]
### reward for the batch: 2
### loss for the batch: 10.729281425476074

Batch: 1
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.18433, 0.16129, 0.10313, 0.15223, 0.074, 0.09715, 0.16661, 0.06126]
### reward for the batch: 2
### loss for the batch: 8.417912483215332

Batch: 2
cids for sample[-1] in batch: [4 6]
Cand prob for sample[-1] in batch: [0.07611, 0.07293, 0.03735, 0.04289, 0.18817, 0.05478, 0.1289, 0.39887]
### reward for the batch: 0
### loss for the batch: -0.8594527244567871

Batch: 3
cids for sample[-1] in batch: [2 4]
Cand prob for sample[-1] in batch: [0.11986, 0.10487, 0.07962, 0.08595, 0.14856, 0.05239, 0.14101, 0.26774]
### reward for the batch: 2
### loss for the batch: 9.36592960357666

Batch: 4
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.1428, 0.08543, 0.08939, 0.07326, 0.13381, 0.09385, 0.10791, 0.27356]
### reward for the batch: 2
### loss for the batch: 8.675731658935547

Batch: 5
cids for sample[-1] in batch: [4 7]
Cand prob for sample[-1] in batch: [0.16453, 0.06468, 0.09486, 0.08328, 0.0999, 0.18186, 0.12717, 0.1837]
### reward for the batch: 2
### loss for the batch: 8.79838752746582

Batch: 6
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.1308, 0.06052, 0.1015, 0.08677, 0.10781, 0.19488, 0.12454, 0.19316]
### reward for the batch: 2
### loss for the batch: 7.8576836585998535

Batch: 7
cids for sample[-1] in batch: [3 4]
Cand prob for sample[-1] in batch: [0.11546, 0.05923, 0.09141, 0.04509, 0.18148, 0.09187, 0.13204, 0.28342]
### reward for the batch: 2
### loss for the batch: 10.392927169799805

Batch: 8
cids for sample[-1] in batch: [4 1]
Cand prob for sample[-1] in batch: [0.16897, 0.08958, 0.06885, 0.08164, 0.05172, 0.32365, 0.162, 0.05358]
### reward for the batch: 2
### loss for the batch: 10.008323669433594

Batch: 9
cids for sample[-1] in batch: [5 1]
Cand prob for sample[-1] in batch: [0.22085, 0.11457, 0.09041, 0.07039, 0.11182, 0.1496, 0.15213, 0.09023]
### reward for the batch: 2
### loss for the batch: 8.016156196594238

============================================
### Epoch: 10 / 20
### Total reward: 18, Total loss: 81.40288, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_10.pt
============================================

Epoch: 11
Batch: 0
cids for sample[-1] in batch: [5 3]
Cand prob for sample[-1] in batch: [0.15, 0.13064, 0.11706, 0.19513, 0.03123, 0.23136, 0.11982, 0.02476]
### reward for the batch: 2
### loss for the batch: 7.310567855834961

Batch: 1
cids for sample[-1] in batch: [0 1]
Cand prob for sample[-1] in batch: [0.17313, 0.14713, 0.05521, 0.13511, 0.01241, 0.30779, 0.16311, 0.00612]
### reward for the batch: 2
### loss for the batch: 8.725926399230957

Batch: 2
cids for sample[-1] in batch: [0 3]
Cand prob for sample[-1] in batch: [0.14218, 0.16206, 0.04461, 0.10509, 0.02667, 0.31296, 0.19366, 0.01276]
### reward for the batch: 0
### loss for the batch: 1.6949596405029297

Batch: 3
cids for sample[-1] in batch: [1 6]
Cand prob for sample[-1] in batch: [0.20607, 0.21236, 0.06707, 0.1872, 0.01254, 0.18125, 0.12683, 0.00668]
### reward for the batch: 2
### loss for the batch: 7.945713520050049

Batch: 4
cids for sample[-1] in batch: [3 0]
Cand prob for sample[-1] in batch: [0.22577, 0.307, 0.06825, 0.12792, 0.01636, 0.13361, 0.113, 0.00807]
### reward for the batch: 2
### loss for the batch: 10.911382675170898

Batch: 5
cids for sample[-1] in batch: [6 3]
Cand prob for sample[-1] in batch: [0.27471, 0.19168, 0.07889, 0.1537, 0.01335, 0.15885, 0.12358, 0.00524]
### reward for the batch: 2
### loss for the batch: 10.479425430297852

Batch: 6
cids for sample[-1] in batch: [5 2]
Cand prob for sample[-1] in batch: [0.24712, 0.19364, 0.10798, 0.19697, 0.01379, 0.13359, 0.10235, 0.00456]
### reward for the batch: 2
### loss for the batch: 7.2017364501953125

Batch: 7
cids for sample[-1] in batch: [1 3]
Cand prob for sample[-1] in batch: [0.20502, 0.17821, 0.14487, 0.24336, 0.02794, 0.10393, 0.08523, 0.01145]
### reward for the batch: 2
### loss for the batch: 12.145843505859375

Batch: 8
cids for sample[-1] in batch: [5 1]
Cand prob for sample[-1] in batch: [0.18105, 0.28291, 0.10444, 0.15573, 0.05008, 0.09909, 0.11411, 0.01259]
### reward for the batch: 2
### loss for the batch: 11.507433891296387

Batch: 9
cids for sample[-1] in batch: [4 0]
Cand prob for sample[-1] in batch: [0.16766, 0.1777, 0.13313, 0.19585, 0.09524, 0.09434, 0.09288, 0.0432]
### reward for the batch: 2
### loss for the batch: 8.422329902648926

============================================
### Epoch: 11 / 20
### Total reward: 18, Total loss: 86.34532, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_11.pt
============================================

Epoch: 12
Batch: 0
cids for sample[-1] in batch: [1 6]
Cand prob for sample[-1] in batch: [0.10955, 0.14069, 0.16714, 0.18816, 0.1186, 0.10477, 0.0914, 0.0797]
### reward for the batch: 2
### loss for the batch: 8.012674331665039

Batch: 1
cids for sample[-1] in batch: [6 1]
Cand prob for sample[-1] in batch: [0.11479, 0.11672, 0.10459, 0.10471, 0.20197, 0.12041, 0.14335, 0.09347]
### reward for the batch: 2
### loss for the batch: 8.903462409973145

Batch: 2
cids for sample[-1] in batch: [0 4]
Cand prob for sample[-1] in batch: [0.0521, 0.08756, 0.07271, 0.04181, 0.38824, 0.06824, 0.12598, 0.16336]
### reward for the batch: 0
### loss for the batch: -0.4708065986633301

Batch: 3
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.05098, 0.13397, 0.11333, 0.05539, 0.3062, 0.04864, 0.09722, 0.19427]
### reward for the batch: 2
### loss for the batch: 7.767260551452637

Batch: 4
cids for sample[-1] in batch: [4 7]
Cand prob for sample[-1] in batch: [0.02776, 0.11515, 0.05848, 0.01179, 0.40511, 0.01902, 0.07956, 0.28312]
### reward for the batch: 2
### loss for the batch: 9.213542938232422

Batch: 5
cids for sample[-1] in batch: [6 5]
Cand prob for sample[-1] in batch: [0.05261, 0.0983, 0.06997, 0.0144, 0.33939, 0.03047, 0.16547, 0.22939]
### reward for the batch: 2
### loss for the batch: 10.494064331054688

Batch: 6
cids for sample[-1] in batch: [4 7]
Cand prob for sample[-1] in batch: [0.06767, 0.12857, 0.12075, 0.03032, 0.16308, 0.05254, 0.23697, 0.2001]
### reward for the batch: 2
### loss for the batch: 8.826608657836914

Batch: 7
cids for sample[-1] in batch: [1 4]
Cand prob for sample[-1] in batch: [0.07264, 0.195, 0.14177, 0.04543, 0.0712, 0.05288, 0.25703, 0.16405]
### reward for the batch: 2
### loss for the batch: 7.238398551940918

Batch: 8
cids for sample[-1] in batch: [2 4]
Cand prob for sample[-1] in batch: [0.07104, 0.11806, 0.08282, 0.03366, 0.07554, 0.07175, 0.42433, 0.12279]
### reward for the batch: 2
### loss for the batch: 8.331326484680176

Batch: 9
cids for sample[-1] in batch: [0 6]
Cand prob for sample[-1] in batch: [0.0829, 0.18994, 0.19126, 0.07025, 0.02244, 0.07681, 0.30219, 0.06421]
### reward for the batch: 2
### loss for the batch: 9.633306503295898

============================================
### Epoch: 12 / 20
### Total reward: 18, Total loss: 77.94984, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_12.pt
============================================

Epoch: 13
Batch: 0
cids for sample[-1] in batch: [0 6]
Cand prob for sample[-1] in batch: [0.08276, 0.17885, 0.28606, 0.08394, 0.00533, 0.10551, 0.23333, 0.02421]
### reward for the batch: 0
### loss for the batch: 1.674673080444336

Batch: 1
cids for sample[-1] in batch: [2 5]
Cand prob for sample[-1] in batch: [0.14005, 0.10447, 0.19969, 0.08162, 0.00741, 0.16312, 0.28584, 0.01781]
### reward for the batch: 2
### loss for the batch: 9.375587463378906

Batch: 2
cids for sample[-1] in batch: [5 1]
Cand prob for sample[-1] in batch: [0.16175, 0.09579, 0.2525, 0.09972, 0.0095, 0.17692, 0.18527, 0.01854]
### reward for the batch: 0
### loss for the batch: 2.371344566345215

Batch: 3
cids for sample[-1] in batch: [6 2]
Cand prob for sample[-1] in batch: [0.1199, 0.20531, 0.378, 0.12032, 0.00939, 0.07821, 0.06972, 0.01916]
### reward for the batch: 2
### loss for the batch: 13.139184951782227

Batch: 4
cids for sample[-1] in batch: [2 0]
Cand prob for sample[-1] in batch: [0.14807, 0.17149, 0.30311, 0.11735, 0.02171, 0.11561, 0.08822, 0.03444]
### reward for the batch: 2
### loss for the batch: 9.008642196655273

Batch: 5
cids for sample[-1] in batch: [2 0]
Cand prob for sample[-1] in batch: [0.19347, 0.0917, 0.2381, 0.12341, 0.04639, 0.14633, 0.12388, 0.03672]
### reward for the batch: 2
### loss for the batch: 7.890180587768555

Batch: 6
cids for sample[-1] in batch: [3 6]
Cand prob for sample[-1] in batch: [0.13467, 0.11889, 0.31197, 0.12264, 0.07683, 0.10168, 0.09117, 0.04216]
### reward for the batch: 2
### loss for the batch: 9.523609161376953

Batch: 7
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.09531, 0.22581, 0.29581, 0.12572, 0.09325, 0.04905, 0.05632, 0.05873]
### reward for the batch: 2
### loss for the batch: 9.786231994628906

Batch: 8
cids for sample[-1] in batch: [4 0]
Cand prob for sample[-1] in batch: [0.08262, 0.07798, 0.11535, 0.09646, 0.33668, 0.05798, 0.08575, 0.14718]
### reward for the batch: 2
### loss for the batch: 7.206703186035156

Batch: 9
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.07504, 0.07817, 0.09768, 0.08258, 0.45893, 0.02617, 0.05766, 0.12378]
### reward for the batch: 2
### loss for the batch: 8.502001762390137

============================================
### Epoch: 13 / 20
### Total reward: 16, Total loss: 78.47816, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_13.pt
============================================

Epoch: 14
Batch: 0
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.09317, 0.09998, 0.08404, 0.10075, 0.32258, 0.04813, 0.08431, 0.16704]
### reward for the batch: 2
### loss for the batch: 6.780724048614502

Batch: 1
cids for sample[-1] in batch: [0 4]
Cand prob for sample[-1] in batch: [0.06485, 0.02004, 0.02426, 0.05098, 0.52048, 0.0361, 0.09612, 0.18717]
### reward for the batch: 2
### loss for the batch: 8.874754905700684

Batch: 2
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.04898, 0.00834, 0.00792, 0.02876, 0.6075, 0.02442, 0.07357, 0.2005]
### reward for the batch: 0
### loss for the batch: -2.7960994243621826

Batch: 3
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.06125, 0.02172, 0.0107, 0.03391, 0.46122, 0.01303, 0.09758, 0.30057]
### reward for the batch: 2
### loss for the batch: 6.07874870300293

Batch: 4
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.07571, 0.01301, 0.00804, 0.03713, 0.30037, 0.01671, 0.10521, 0.44382]
### reward for the batch: 2
### loss for the batch: 10.200227737426758

Batch: 5
cids for sample[-1] in batch: [7 3]
Cand prob for sample[-1] in batch: [0.1261, 0.0088, 0.00819, 0.04523, 0.21229, 0.0231, 0.17201, 0.40428]
### reward for the batch: 2
### loss for the batch: 11.132662773132324

Batch: 6
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.14858, 0.01252, 0.00987, 0.05814, 0.07699, 0.03375, 0.20624, 0.45391]
### reward for the batch: 2
### loss for the batch: 7.593105316162109

Batch: 7
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.22249, 0.05003, 0.02574, 0.09104, 0.02024, 0.0545, 0.21591, 0.32004]
### reward for the batch: 2
### loss for the batch: 6.152449607849121

Batch: 8
cids for sample[-1] in batch: [0 6]
Cand prob for sample[-1] in batch: [0.25582, 0.0178, 0.01939, 0.08456, 0.00527, 0.13714, 0.25934, 0.22068]
### reward for the batch: 2
### loss for the batch: 10.77900218963623

Batch: 9
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.32429, 0.02598, 0.02713, 0.11036, 0.00351, 0.16759, 0.17437, 0.16677]
### reward for the batch: 2
### loss for the batch: 10.56373119354248

============================================
### Epoch: 14 / 20
### Total reward: 18, Total loss: 75.35931, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_14.pt
============================================

Epoch: 15
Batch: 0
cids for sample[-1] in batch: [0 5]
Cand prob for sample[-1] in batch: [0.26225, 0.05096, 0.02966, 0.18947, 0.0016, 0.25444, 0.12931, 0.08232]
### reward for the batch: 2
### loss for the batch: 9.182971954345703

Batch: 1
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.30786, 0.01671, 0.02786, 0.17802, 0.00067, 0.32697, 0.10788, 0.03403]
### reward for the batch: 2
### loss for the batch: 15.284340858459473

Batch: 2
cids for sample[-1] in batch: [3 0]
Cand prob for sample[-1] in batch: [0.30159, 0.02468, 0.03682, 0.19505, 0.00151, 0.31389, 0.08123, 0.04523]
### reward for the batch: 0
### loss for the batch: -2.069565773010254

Batch: 3
cids for sample[-1] in batch: [6 5]
Cand prob for sample[-1] in batch: [0.17152, 0.20592, 0.14568, 0.22388, 0.00656, 0.08874, 0.10009, 0.05761]
### reward for the batch: 2
### loss for the batch: 8.479058265686035

Batch: 4
cids for sample[-1] in batch: [3 0]
Cand prob for sample[-1] in batch: [0.13857, 0.1656, 0.30064, 0.22618, 0.00406, 0.06536, 0.07002, 0.02957]
### reward for the batch: 2
### loss for the batch: 8.374072074890137

Batch: 5
cids for sample[-1] in batch: [2 7]
Cand prob for sample[-1] in batch: [0.11914, 0.10109, 0.35012, 0.21348, 0.01529, 0.06977, 0.09964, 0.03148]
### reward for the batch: 2
### loss for the batch: 5.392114639282227

Batch: 6
cids for sample[-1] in batch: [7 2]
Cand prob for sample[-1] in batch: [0.08533, 0.09983, 0.39375, 0.23355, 0.01751, 0.05551, 0.08235, 0.03216]
### reward for the batch: 2
### loss for the batch: 11.690410614013672

Batch: 7
cids for sample[-1] in batch: [3 2]
Cand prob for sample[-1] in batch: [0.05877, 0.21895, 0.33372, 0.1476, 0.06251, 0.03197, 0.0655, 0.08098]
### reward for the batch: 2
### loss for the batch: 9.991073608398438

Batch: 8
cids for sample[-1] in batch: [3 6]
Cand prob for sample[-1] in batch: [0.09487, 0.09233, 0.29492, 0.18713, 0.06581, 0.10512, 0.08432, 0.07551]
### reward for the batch: 2
### loss for the batch: 8.202437400817871

Batch: 9
cids for sample[-1] in batch: [3 7]
Cand prob for sample[-1] in batch: [0.08989, 0.09447, 0.21546, 0.15399, 0.17362, 0.05459, 0.07805, 0.13992]
### reward for the batch: 2
### loss for the batch: 8.027042388916016

============================================
### Epoch: 15 / 20
### Total reward: 18, Total loss: 82.55396, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_15.pt
============================================

Epoch: 16
Batch: 0
cids for sample[-1] in batch: [4 3]
Cand prob for sample[-1] in batch: [0.10418, 0.05341, 0.21725, 0.30866, 0.06374, 0.07825, 0.06819, 0.10632]
### reward for the batch: 2
### loss for the batch: 9.6032133102417

Batch: 1
cids for sample[-1] in batch: [3 0]
Cand prob for sample[-1] in batch: [0.14295, 0.02121, 0.16426, 0.30115, 0.08275, 0.11667, 0.09682, 0.0742]
### reward for the batch: 2
### loss for the batch: 6.912015914916992

Batch: 2
cids for sample[-1] in batch: [3 4]
Cand prob for sample[-1] in batch: [0.14312, 0.01855, 0.05738, 0.19092, 0.29678, 0.08746, 0.09055, 0.11525]
### reward for the batch: 0
### loss for the batch: -0.15365839004516602

Batch: 3
cids for sample[-1] in batch: [4 6]
Cand prob for sample[-1] in batch: [0.04623, 0.01666, 0.02134, 0.08088, 0.59491, 0.03027, 0.07405, 0.13567]
### reward for the batch: 2
### loss for the batch: 7.851133346557617

Batch: 4
cids for sample[-1] in batch: [3 7]
Cand prob for sample[-1] in batch: [0.10257, 0.01961, 0.03592, 0.34302, 0.22428, 0.0729, 0.06429, 0.1374]
### reward for the batch: 2
### loss for the batch: 8.474724769592285

Batch: 5
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.11765, 0.01028, 0.02565, 0.35576, 0.20666, 0.08639, 0.09894, 0.09867]
### reward for the batch: 2
### loss for the batch: 10.211692810058594

Batch: 6
cids for sample[-1] in batch: [3 7]
Cand prob for sample[-1] in batch: [0.13314, 0.01635, 0.01745, 0.2661, 0.17524, 0.09788, 0.14805, 0.14578]
### reward for the batch: 2
### loss for the batch: 6.5315656661987305

Batch: 7
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.07769, 0.02132, 0.00677, 0.14356, 0.21787, 0.03593, 0.09552, 0.40134]
### reward for the batch: 2
### loss for the batch: 6.9265265464782715

Batch: 8
cids for sample[-1] in batch: [7 3]
Cand prob for sample[-1] in batch: [0.10818, 0.01577, 0.00964, 0.23878, 0.12627, 0.09543, 0.12415, 0.28178]
### reward for the batch: 2
### loss for the batch: 6.061877250671387

Batch: 9
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.06041, 0.0122, 0.00309, 0.11669, 0.07864, 0.02784, 0.0688, 0.63232]
### reward for the batch: 2
### loss for the batch: 8.336684226989746

============================================
### Epoch: 16 / 20
### Total reward: 18, Total loss: 70.75578, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_16.pt
============================================

Epoch: 17
Batch: 0
cids for sample[-1] in batch: [3 7]
Cand prob for sample[-1] in batch: [0.09762, 0.01085, 0.00464, 0.24325, 0.03316, 0.04176, 0.06726, 0.50146]
### reward for the batch: 2
### loss for the batch: 9.861361503601074

Batch: 1
cids for sample[-1] in batch: [3 0]
Cand prob for sample[-1] in batch: [0.19555, 0.00432, 0.00569, 0.46098, 0.01826, 0.06854, 0.08537, 0.16129]
### reward for the batch: 2
### loss for the batch: 12.452552795410156

Batch: 2
cids for sample[-1] in batch: [3 0]
Cand prob for sample[-1] in batch: [0.28212, 0.0056, 0.00424, 0.44655, 0.01388, 0.0724, 0.07056, 0.10464]
### reward for the batch: 0
### loss for the batch: 1.1133325099945068

Batch: 3
cids for sample[-1] in batch: [3 7]
Cand prob for sample[-1] in batch: [0.19367, 0.01951, 0.00777, 0.33711, 0.04485, 0.07184, 0.11138, 0.21388]
### reward for the batch: 2
### loss for the batch: 8.839198112487793

Batch: 4
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.21154, 0.08104, 0.02244, 0.33677, 0.05566, 0.08034, 0.08021, 0.132]
### reward for the batch: 2
### loss for the batch: 8.010549545288086

Batch: 5
cids for sample[-1] in batch: [6 3]
Cand prob for sample[-1] in batch: [0.20099, 0.099, 0.01765, 0.15613, 0.13778, 0.08741, 0.18225, 0.11878]
### reward for the batch: 2
### loss for the batch: 7.703184127807617

Batch: 6
cids for sample[-1] in batch: [1 0]
Cand prob for sample[-1] in batch: [0.10971, 0.33811, 0.01307, 0.05182, 0.18023, 0.04778, 0.17128, 0.088]
### reward for the batch: 2
### loss for the batch: 6.094786643981934

Batch: 7
cids for sample[-1] in batch: [7 1]
Cand prob for sample[-1] in batch: [0.05621, 0.53075, 0.00616, 0.03645, 0.15786, 0.01675, 0.06564, 0.13017]
### reward for the batch: 2
### loss for the batch: 11.231678009033203

Batch: 8
cids for sample[-1] in batch: [4 7]
Cand prob for sample[-1] in batch: [0.07129, 0.39737, 0.00875, 0.03504, 0.21406, 0.03529, 0.07678, 0.16142]
### reward for the batch: 2
### loss for the batch: 8.055320739746094

Batch: 9
cids for sample[-1] in batch: [4 1]
Cand prob for sample[-1] in batch: [0.07776, 0.2659, 0.00678, 0.05977, 0.22305, 0.02791, 0.05686, 0.28197]
### reward for the batch: 2
### loss for the batch: 7.530861854553223

============================================
### Epoch: 17 / 20
### Total reward: 18, Total loss: 80.89283, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_17.pt
============================================

Epoch: 18
Batch: 0
cids for sample[-1] in batch: [5 1]
Cand prob for sample[-1] in batch: [0.04975, 0.16256, 0.0047, 0.05755, 0.27084, 0.02928, 0.04385, 0.38148]
### reward for the batch: 2
### loss for the batch: 7.123156547546387

Batch: 1
cids for sample[-1] in batch: [4 7]
Cand prob for sample[-1] in batch: [0.06217, 0.06215, 0.00417, 0.0847, 0.3249, 0.04961, 0.06097, 0.35133]
### reward for the batch: 2
### loss for the batch: 5.807156085968018

Batch: 2
cids for sample[-1] in batch: [3 7]
Cand prob for sample[-1] in batch: [0.04505, 0.01956, 0.00102, 0.14318, 0.27673, 0.03918, 0.02246, 0.45283]
### reward for the batch: 0
### loss for the batch: 1.9427170753479004

Batch: 3
cids for sample[-1] in batch: [3 7]
Cand prob for sample[-1] in batch: [0.04624, 0.01907, 0.00242, 0.29598, 0.20316, 0.06774, 0.03524, 0.33015]
### reward for the batch: 2
### loss for the batch: 5.5684099197387695

Batch: 4
cids for sample[-1] in batch: [3 7]
Cand prob for sample[-1] in batch: [0.07139, 0.04376, 0.00942, 0.33906, 0.18096, 0.08086, 0.03379, 0.24076]
### reward for the batch: 2
### loss for the batch: 8.05059814453125

Batch: 5
cids for sample[-1] in batch: [3 5]
Cand prob for sample[-1] in batch: [0.07843, 0.01752, 0.00522, 0.35404, 0.20835, 0.10477, 0.06292, 0.16874]
### reward for the batch: 2
### loss for the batch: 8.970748901367188

Batch: 6
cids for sample[-1] in batch: [3 5]
Cand prob for sample[-1] in batch: [0.07963, 0.01785, 0.0062, 0.38981, 0.21764, 0.12894, 0.064, 0.09594]
### reward for the batch: 2
### loss for the batch: 9.017967224121094

Batch: 7
cids for sample[-1] in batch: [4 3]
Cand prob for sample[-1] in batch: [0.07092, 0.00566, 0.0031, 0.66538, 0.05235, 0.09702, 0.03082, 0.07475]
### reward for the batch: 2
### loss for the batch: 11.953147888183594

Batch: 8
cids for sample[-1] in batch: [3 0]
Cand prob for sample[-1] in batch: [0.15892, 0.01892, 0.02443, 0.3496, 0.09932, 0.14351, 0.13664, 0.06866]
### reward for the batch: 2
### loss for the batch: 7.512102127075195

Batch: 9
cids for sample[-1] in batch: [6 3]
Cand prob for sample[-1] in batch: [0.18303, 0.03979, 0.10397, 0.29342, 0.05794, 0.07955, 0.20228, 0.04001]
### reward for the batch: 2
### loss for the batch: 7.096871852874756

============================================
### Epoch: 18 / 20
### Total reward: 18, Total loss: 73.04288, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_18.pt
============================================

Epoch: 19
Batch: 0
cids for sample[-1] in batch: [6 3]
Cand prob for sample[-1] in batch: [0.14338, 0.05948, 0.14508, 0.18236, 0.06302, 0.09318, 0.26022, 0.05329]
### reward for the batch: 2
### loss for the batch: 10.327293395996094

Batch: 1
cids for sample[-1] in batch: [0 2]
Cand prob for sample[-1] in batch: [0.12567, 0.04592, 0.15713, 0.10418, 0.03925, 0.04426, 0.45592, 0.02769]
### reward for the batch: 2
### loss for the batch: 9.337431907653809

Batch: 2
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.19722, 0.0294, 0.11798, 0.21475, 0.03627, 0.05778, 0.30981, 0.0368]
### reward for the batch: 0
### loss for the batch: -0.34744787216186523

Batch: 3
cids for sample[-1] in batch: [6 2]
Cand prob for sample[-1] in batch: [0.15031, 0.03159, 0.10141, 0.14036, 0.05204, 0.04398, 0.44298, 0.03734]
### reward for the batch: 2
### loss for the batch: 7.359562873840332

Batch: 4
cids for sample[-1] in batch: [0 1]
Cand prob for sample[-1] in batch: [0.11354, 0.11799, 0.30631, 0.03596, 0.0541, 0.02, 0.30063, 0.05146]
### reward for the batch: 2
### loss for the batch: 7.34953498840332

Batch: 5
cids for sample[-1] in batch: [2 6]
Cand prob for sample[-1] in batch: [0.18388, 0.04346, 0.1134, 0.03276, 0.10694, 0.01998, 0.45943, 0.04016]
### reward for the batch: 2
### loss for the batch: 10.258855819702148

Batch: 6
cids for sample[-1] in batch: [6 0]
Cand prob for sample[-1] in batch: [0.24857, 0.04492, 0.11304, 0.038, 0.20398, 0.0206, 0.30224, 0.02865]
### reward for the batch: 2
### loss for the batch: 7.837453842163086

Batch: 7
cids for sample[-1] in batch: [4 6]
Cand prob for sample[-1] in batch: [0.38783, 0.03221, 0.09639, 0.09836, 0.11682, 0.02855, 0.16949, 0.07037]
### reward for the batch: 2
### loss for the batch: 8.32682991027832

Batch: 8
cids for sample[-1] in batch: [0 4]
Cand prob for sample[-1] in batch: [0.33774, 0.04221, 0.16417, 0.0618, 0.15191, 0.01619, 0.1368, 0.08917]
### reward for the batch: 2
### loss for the batch: 7.781916618347168

Batch: 9
cids for sample[-1] in batch: [0 2]
Cand prob for sample[-1] in batch: [0.29655, 0.04677, 0.20529, 0.06896, 0.13572, 0.00984, 0.12358, 0.11329]
### reward for the batch: 2
### loss for the batch: 7.016301155090332

============================================
### Epoch: 19 / 20
### Total reward: 18, Total loss: 75.24773, Best reward: 18 at epoch 0, Best loss: 68.01346 at epoch 6

saved the ckpt to checkpoints/exp0_autopot_randompolicy/ckpt_19.pt
============================================

