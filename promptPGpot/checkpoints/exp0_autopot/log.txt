Epoch: 0
Batch: 0
cids for sample[-1] in batch: [2 0]
Cand prob for sample[-1] in batch: [0.12387, 0.12174, 0.12673, 0.1413, 0.09684, 0.1145, 0.15117, 0.12384]
### reward for the batch: 2
### loss for the batch: 8.947587013244629

Batch: 1
cids for sample[-1] in batch: [3 2]
Cand prob for sample[-1] in batch: [0.13104, 0.01464, 0.60694, 0.05516, 0.00652, 0.14712, 0.02835, 0.01024]
### reward for the batch: 2
### loss for the batch: 9.423742294311523

Batch: 2
cids for sample[-1] in batch: [5 0]
Cand prob for sample[-1] in batch: [0.2536, 0.02501, 0.45401, 0.10225, 0.00622, 0.12456, 0.02504, 0.00931]
### reward for the batch: 0
### loss for the batch: 0.3280153274536133

Batch: 3
cids for sample[-1] in batch: [2 0]
Cand prob for sample[-1] in batch: [0.60722, 0.02922, 0.11542, 0.06396, 0.00809, 0.14486, 0.024, 0.00722]
### reward for the batch: 2
### loss for the batch: 5.158012390136719

Batch: 4
cids for sample[-1] in batch: [0 5]
Cand prob for sample[-1] in batch: [0.6316, 0.02915, 0.18682, 0.03382, 0.00559, 0.08905, 0.01909, 0.00487]
### reward for the batch: 2
### loss for the batch: 5.307226657867432

Batch: 5
cids for sample[-1] in batch: [0 5]
Cand prob for sample[-1] in batch: [0.6366, 0.02015, 0.19675, 0.01829, 0.00197, 0.11432, 0.01003, 0.00187]
### reward for the batch: 2
### loss for the batch: 8.363557815551758

Batch: 6
cids for sample[-1] in batch: [2 0]
Cand prob for sample[-1] in batch: [0.36984, 0.03509, 0.33754, 0.02696, 0.00263, 0.21325, 0.01245, 0.00225]
### reward for the batch: 2
### loss for the batch: 4.695781707763672

Batch: 7
cids for sample[-1] in batch: [1 5]
Cand prob for sample[-1] in batch: [0.29327, 0.03163, 0.30921, 0.03625, 0.00338, 0.30831, 0.01439, 0.00356]
### reward for the batch: 2
### loss for the batch: 8.692566871643066

Batch: 8
cids for sample[-1] in batch: [6 5]
Cand prob for sample[-1] in batch: [0.1331, 0.08599, 0.22138, 0.05843, 0.01031, 0.45163, 0.02997, 0.00919]
### reward for the batch: 2
### loss for the batch: 6.959627628326416

Batch: 9
cids for sample[-1] in batch: [1 5]
Cand prob for sample[-1] in batch: [0.09656, 0.12874, 0.15293, 0.07518, 0.01743, 0.47245, 0.04191, 0.0148]
### reward for the batch: 2
### loss for the batch: 5.482273101806641

============================================
### Epoch: 0 / 5
### Total reward: 18, Total loss: 63.35839, Best reward: 18 at epoch 0, Best loss: 63.35839 at epoch 0

saved the ckpt to checkpoints/exp0_aotupot/ckpt_0.pt
saved the best reward ckpt to checkpoints/exp0_aotupot/ckpt_best_reward.pt
saved the best loss ckpt to checkpoints/exp0_aotupot/ckpt_best_loss.pt
============================================

Epoch: 1
Batch: 0
cids for sample[-1] in batch: [2 5]
Cand prob for sample[-1] in batch: [0.05593, 0.03718, 0.09423, 0.05118, 0.00188, 0.74361, 0.01334, 0.00264]
### reward for the batch: 2
### loss for the batch: 5.395046234130859

Batch: 1
cids for sample[-1] in batch: [5 3]
Cand prob for sample[-1] in batch: [0.03706, 0.08472, 0.08161, 0.07465, 0.00279, 0.69666, 0.0186, 0.00391]
### reward for the batch: 2
### loss for the batch: 7.443558216094971

Batch: 2
cids for sample[-1] in batch: [5 1]
Cand prob for sample[-1] in batch: [0.03317, 0.19367, 0.05647, 0.11748, 0.01437, 0.50569, 0.05971, 0.01944]
### reward for the batch: 0
### loss for the batch: 0.07500696182250977

Batch: 3
cids for sample[-1] in batch: [4 1]
Cand prob for sample[-1] in batch: [0.02458, 0.50285, 0.0647, 0.0724, 0.04852, 0.16089, 0.09813, 0.02792]
### reward for the batch: 2
### loss for the batch: 5.912899017333984

Batch: 4
cids for sample[-1] in batch: [1 3]
Cand prob for sample[-1] in batch: [0.01544, 0.53589, 0.05014, 0.0646, 0.0775, 0.10866, 0.10689, 0.04087]
### reward for the batch: 2
### loss for the batch: 7.064268112182617

Batch: 5
cids for sample[-1] in batch: [5 1]
Cand prob for sample[-1] in batch: [0.02402, 0.37604, 0.05273, 0.10703, 0.02569, 0.34101, 0.05517, 0.01833]
### reward for the batch: 2
### loss for the batch: 4.958044052124023

Batch: 6
cids for sample[-1] in batch: [1 6]
Cand prob for sample[-1] in batch: [0.01628, 0.50512, 0.03486, 0.11533, 0.03429, 0.2205, 0.05625, 0.01739]
### reward for the batch: 2
### loss for the batch: 6.591277122497559

Batch: 7
cids for sample[-1] in batch: [4 3]
Cand prob for sample[-1] in batch: [0.01734, 0.51611, 0.02249, 0.13438, 0.06979, 0.11526, 0.08819, 0.03644]
### reward for the batch: 2
### loss for the batch: 8.862829208374023

Batch: 8
cids for sample[-1] in batch: [2 6]
Cand prob for sample[-1] in batch: [0.00785, 0.41954, 0.00629, 0.11326, 0.16159, 0.04107, 0.18859, 0.06181]
### reward for the batch: 2
### loss for the batch: 11.536165237426758

Batch: 9
cids for sample[-1] in batch: [1 4]
Cand prob for sample[-1] in batch: [0.01274, 0.29615, 0.01548, 0.12685, 0.25137, 0.02595, 0.18107, 0.09039]
### reward for the batch: 2
### loss for the batch: 7.385256767272949

============================================
### Epoch: 1 / 5
### Total reward: 18, Total loss: 65.22435, Best reward: 18 at epoch 0, Best loss: 63.35839 at epoch 0

saved the ckpt to checkpoints/exp0_aotupot/ckpt_1.pt
============================================

Epoch: 2
Batch: 0
cids for sample[-1] in batch: [2 3]
Cand prob for sample[-1] in batch: [0.04346, 0.06298, 0.0694, 0.44897, 0.0182, 0.28551, 0.05544, 0.01604]
### reward for the batch: 2
### loss for the batch: 6.304512023925781

Batch: 1
cids for sample[-1] in batch: [3 0]
Cand prob for sample[-1] in batch: [0.03601, 0.01854, 0.05984, 0.61525, 0.00564, 0.22758, 0.02865, 0.0085]
### reward for the batch: 2
### loss for the batch: 6.731156349182129

Batch: 2
cids for sample[-1] in batch: [6 3]
Cand prob for sample[-1] in batch: [0.04585, 0.02189, 0.05567, 0.53919, 0.03557, 0.10737, 0.13414, 0.06032]
### reward for the batch: 0
### loss for the batch: -1.0012507438659668

Batch: 3
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.04365, 0.04151, 0.07465, 0.18126, 0.21667, 0.01786, 0.28789, 0.13651]
### reward for the batch: 2
### loss for the batch: 6.566812038421631

Batch: 4
cids for sample[-1] in batch: [7 2]
Cand prob for sample[-1] in batch: [0.0786, 0.01754, 0.1234, 0.26739, 0.08295, 0.02231, 0.27564, 0.13217]
### reward for the batch: 0
### loss for the batch: -0.5223042964935303

Batch: 5
cids for sample[-1] in batch: [6 5]
Cand prob for sample[-1] in batch: [0.16673, 0.00824, 0.12568, 0.41664, 0.01775, 0.06065, 0.15145, 0.05287]
### reward for the batch: 2
### loss for the batch: 7.301843643188477

Batch: 6
cids for sample[-1] in batch: [2 0]
Cand prob for sample[-1] in batch: [0.13845, 0.00711, 0.0535, 0.17974, 0.04381, 0.0087, 0.46004, 0.10866]
### reward for the batch: 2
### loss for the batch: 9.992430686950684

Batch: 7
cids for sample[-1] in batch: [7 6]
Cand prob for sample[-1] in batch: [0.3008, 0.00578, 0.05056, 0.12525, 0.0358, 0.01508, 0.32727, 0.13946]
### reward for the batch: 2
### loss for the batch: 5.524733066558838

Batch: 8
cids for sample[-1] in batch: [6 7]
Cand prob for sample[-1] in batch: [0.29068, 0.00285, 0.0222, 0.03786, 0.01985, 0.01164, 0.4729, 0.14201]
### reward for the batch: 2
### loss for the batch: 6.082598686218262

Batch: 9
cids for sample[-1] in batch: [7 4]
Cand prob for sample[-1] in batch: [0.16398, 0.00418, 0.01247, 0.0099, 0.06135, 0.00461, 0.35766, 0.38585]
### reward for the batch: 2
### loss for the batch: 5.9770307540893555

============================================
### Epoch: 2 / 5
### Total reward: 16, Total loss: 52.95756, Best reward: 18 at epoch 0, Best loss: 52.95756 at epoch 2

saved the ckpt to checkpoints/exp0_aotupot/ckpt_2.pt
saved the best loss ckpt to checkpoints/exp0_aotupot/ckpt_best_loss.pt
============================================

Epoch: 3
Batch: 0
cids for sample[-1] in batch: [0 2]
Cand prob for sample[-1] in batch: [0.72627, 0.00129, 0.04923, 0.03003, 0.00212, 0.10221, 0.05174, 0.0371]
### reward for the batch: 2
### loss for the batch: 6.0140485763549805

Batch: 1
cids for sample[-1] in batch: [5 0]
Cand prob for sample[-1] in batch: [0.74115, 0.00056, 0.03194, 0.01878, 0.00079, 0.15685, 0.01755, 0.03239]
### reward for the batch: 2
### loss for the batch: 6.269319534301758

Batch: 2
cids for sample[-1] in batch: [7 0]
Cand prob for sample[-1] in batch: [0.36093, 0.00086, 0.01449, 0.00618, 0.00672, 0.15978, 0.05682, 0.39421]
### reward for the batch: 0
### loss for the batch: 0.39428138732910156

Batch: 3
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.07259, 0.00296, 0.00893, 0.00103, 0.05372, 0.01885, 0.03709, 0.80484]
### reward for the batch: 2
### loss for the batch: 4.65657901763916

Batch: 4
cids for sample[-1] in batch: [0 7]
Cand prob for sample[-1] in batch: [0.32102, 0.00241, 0.0348, 0.00391, 0.00838, 0.3693, 0.01702, 0.24317]
### reward for the batch: 0
### loss for the batch: -0.23816394805908203

Batch: 5
cids for sample[-1] in batch: [0 5]
Cand prob for sample[-1] in batch: [0.06926, 0.00013, 0.00969, 0.00072, 5e-05, 0.91775, 0.00033, 0.00207]
### reward for the batch: 2
### loss for the batch: 7.290103912353516

Batch: 6
cids for sample[-1] in batch: [0 5]
Cand prob for sample[-1] in batch: [0.18589, 0.00148, 0.05755, 0.00151, 0.00047, 0.74346, 0.00122, 0.00841]
### reward for the batch: 0
### loss for the batch: 0.6066696643829346

Batch: 7
cids for sample[-1] in batch: [2 5]
Cand prob for sample[-1] in batch: [0.23432, 0.00442, 0.0812, 0.0022, 0.00265, 0.63824, 0.00292, 0.03405]
### reward for the batch: 2
### loss for the batch: 5.202693939208984

Batch: 8
cids for sample[-1] in batch: [5 2]
Cand prob for sample[-1] in batch: [0.22513, 0.01193, 0.16294, 0.00169, 0.00292, 0.56343, 0.00389, 0.02807]
### reward for the batch: 2
### loss for the batch: 6.3772873878479

Batch: 9
cids for sample[-1] in batch: [1 0]
Cand prob for sample[-1] in batch: [0.25079, 0.07404, 0.49498, 0.00161, 0.01802, 0.11466, 0.00361, 0.04228]
### reward for the batch: 2
### loss for the batch: 6.284813404083252

============================================
### Epoch: 3 / 5
### Total reward: 14, Total loss: 42.85763, Best reward: 18 at epoch 0, Best loss: 42.85763 at epoch 3

saved the ckpt to checkpoints/exp0_aotupot/ckpt_3.pt
saved the best loss ckpt to checkpoints/exp0_aotupot/ckpt_best_loss.pt
============================================

Epoch: 4
Batch: 0
cids for sample[-1] in batch: [0 2]
Cand prob for sample[-1] in batch: [0.12008, 0.00235, 0.82862, 0.00048, 0.0, 0.04843, 1e-05, 1e-05]
### reward for the batch: 2
### loss for the batch: 6.2963056564331055

Batch: 1
cids for sample[-1] in batch: [5 2]
Cand prob for sample[-1] in batch: [0.21623, 0.00388, 0.75778, 0.00049, 0.0, 0.02162, 0.0, 0.0]
### reward for the batch: 2
### loss for the batch: 6.111028671264648

Batch: 2
cids for sample[-1] in batch: [1 2]
Cand prob for sample[-1] in batch: [0.52837, 0.04244, 0.40208, 0.00078, 0.00016, 0.02562, 0.00017, 0.00037]
### reward for the batch: 0
### loss for the batch: 2.179771661758423

Batch: 3
cids for sample[-1] in batch: [2 1]
Cand prob for sample[-1] in batch: [0.05101, 0.81033, 0.13545, 0.00023, 0.00166, 0.00089, 0.00016, 0.00026]
### reward for the batch: 2
### loss for the batch: 4.1198344230651855

Batch: 4
cids for sample[-1] in batch: [2 1]
Cand prob for sample[-1] in batch: [0.02995, 0.81595, 0.15312, 0.00018, 0.00017, 0.00057, 3e-05, 2e-05]
### reward for the batch: 2
### loss for the batch: 5.383079528808594

Batch: 5
cids for sample[-1] in batch: [0 1]
Cand prob for sample[-1] in batch: [0.02723, 0.57053, 0.40137, 0.00016, 3e-05, 0.00066, 1e-05, 0.0]
### reward for the batch: 2
### loss for the batch: 5.665980339050293

Batch: 6
cids for sample[-1] in batch: [2 1]
Cand prob for sample[-1] in batch: [0.00334, 0.86976, 0.1268, 3e-05, 3e-05, 3e-05, 0.0, 0.0]
### reward for the batch: 2
### loss for the batch: 3.8070170879364014

Batch: 7
cids for sample[-1] in batch: [1 2]
Cand prob for sample[-1] in batch: [0.00791, 0.78973, 0.20187, 0.00011, 0.00024, 0.0001, 3e-05, 1e-05]
### reward for the batch: 2
### loss for the batch: 3.335282564163208

Batch: 8
cids for sample[-1] in batch: [2 1]
Cand prob for sample[-1] in batch: [0.00677, 0.60929, 0.38353, 9e-05, 0.00016, 0.00011, 4e-05, 1e-05]
### reward for the batch: 2
### loss for the batch: 4.090400218963623

Batch: 9
cids for sample[-1] in batch: [2 1]
Cand prob for sample[-1] in batch: [0.00804, 0.62596, 0.36504, 0.00012, 0.00065, 0.0001, 5e-05, 3e-05]
### reward for the batch: 2
### loss for the batch: 3.5414376258850098

============================================
### Epoch: 4 / 5
### Total reward: 18, Total loss: 44.53014, Best reward: 18 at epoch 0, Best loss: 42.85763 at epoch 3

saved the ckpt to checkpoints/exp0_aotupot/ckpt_4.pt
============================================

